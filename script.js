// Initialize chart variable
let statisticsChart = null;

const YIN_SYMBOL = '\u2013 \u2013'; // '– –' (broken line)
const YANG_SYMBOL  = '\u2501\u2501\u2501'; // '━━━' (solid line)
const YIN_MOVING_SYMBOL = YIN_SYMBOL + 'X'; // '– –X' (broken line with X)
const YANG_MOVING_SYMBOL = YANG_SYMBOL + 'O'; // '━━━O' (solid line with O)

const YIN = 0;
const YANG = 1;
const diZhiChinese = ["子","丑","寅","卯","辰","巳","午","未","申","酉","戌","亥"];
const diZhiElement = ["水","土","木","木","土","火","火","土","金","金","土","水"];
const elementRelation = {
  '水': {'generate': '木', 'overcome': '火', 'generate_by': '金', 'overcome_by': '土'},
  '木': {'generate': '火', 'overcome': '土', 'generate_by': '水', 'overcome_by': '金'},
  '火': {'generate': '土', 'overcome': '金', 'generate_by': '木', 'overcome_by': '水'},
  '土': {'generate': '金', 'overcome': '水', 'generate_by': '火', 'overcome_by': '木'},
  '金': {'generate': '水', 'overcome': '木', 'generate_by': '火', 'overcome_by': '土'}  
};



// Hex dictionary for result lookup
const hexDict = {
    '000000': 2, '100000': 23, '010000': 8, '110000': 20, '001000': 16, '101000': 35,
    '011000': 45, '111000': 12, '000001': 24, '100001': 27, '010001': 3, '110001': 42,
    '001001': 51, '101001': 21, '011001': 17, '111001': 25, '000010': 7, '100010': 4,
    '010010': 29, '110010': 59, '001010': 40, '101010': 64, '011010': 47, '111010': 6,
    '000011': 19, '100011': 41, '010011': 60, '110011': 61, '001011': 54, '101011': 38,
    '011011': 58, '111011': 10, '000100': 15, '100100': 52, '010100': 39, '110100': 53,
    '001100': 62, '101100': 56, '011100': 31, '111100': 33, '000101': 36, '100101': 22,
    '010101': 63, '110101': 37, '001101': 55, '101101': 30, '011101': 49, '111101': 13,
    '000110': 46, '100110': 18, '010110': 48, '110110': 57, '001110': 32, '101110': 50,
    '011110': 28, '111110': 44, '000111': 11, '100111': 26, '010111': 5, '110111': 9,
    '001111': 34, '101111': 14, '011111': 43, '111111': 1
};



const ichingData = {
  "trigrams": [
    {"id": 0, "name": "坤", "pinyin": "Kun", "binary": "000", "code": "\u2637", "diZhiBase": 7, "YinYang": YIN, "element": "土"},
    {"id": 1, "name": "震", "pinyin": "Zhen", "binary": "001", "code": "\u2633", "diZhiBase": 0, "YinYang": YANG, "element": "木"},
    {"id": 2, "name": "坎", "pinyin": "Kan", "binary": "010", "code": "\u2635", "diZhiBase": 2, "YinYang": YANG, "element": "水"},
    {"id": 3, "name": "兌", "pinyin": "Dui", "binary": "011", "code": "\u2631", "diZhiBase": 5, "YinYang": YIN, "element": "金"},
    {"id": 4, "name": "艮", "pinyin": "Gen", "binary": "100", "code": "\u2636", "diZhiBase": 4, "YinYang": YANG, "element": "土"},
    {"id": 5, "name": "離", "pinyin": "Li", "binary": "101", "code": "\u2632", "diZhiBase": 3, "YinYang": YIN, "element": "火"},
    {"id": 6, "name": "巽", "pinyin": "Xun", "binary": "110", "code": "\u2634", "diZhiBase": 1, "YinYang": YIN, "element": "木"},
    {"id": 7, "name": "乾", "pinyin": "Qian", "binary": "111", "code": "\u2630", "diZhiBase": 0, "YinYang": YANG, "element": "金"}
  ],
  "hexagrams": [
    {
      "id": 1,
      "name": "乾",
      "pinyin": "Qian",
      "symbol": "乾上乾下",
      "trigram_upper": 7,
      "trigram_lower": 7,
      "short": "乾為天",
      "ci": "元亨，利貞。",
      "ci_white": "至大至剛，極其通順，利於守正。",
      "yao_white": [
        "初九：潛龍勿用。（白話：龍潛於深淵，暫時不可行動。）",
        "九二：見龍在田，利見大人。（白話：龍出現在田野，有利於出現大人物。）",
        "九三：君子終日乾乾，夕惕若，厲無咎。（白話：君子整天自強不息，晚上仍保持警覺，雖危險終無咎害。）",
        "九四：或躍在淵，無咎。（白話：或跳入深淵或躍起，都無害。）",
        "九五：飛龍在天，利見大人。（白話：龍飛在天上，大人物出現最有利。）",
        "上九：亢龍有悔。（白話：龍飛得太高，必然有悔恨。）"
      ]
    },
    {
      "id": 2,
      "name": "坤",
      "pinyin": "Kun",
      "symbol": "坤上坤下",
      "trigram_upper": 0,
      "trigram_lower": 0,
      "short": "坤為地",
      "ci": "元亨。利牝馬之貞。君子有攸往，先迷後得主，利。西南得朋，東北喪朋。安貞吉。",
      "ci_white": "極其柔順通達，利於像母馬一樣柔順守正。君子有所行動，先迷路後找到主軸，吉利。西南得朋友，東北失朋友，安於正道吉祥。",
      "yao_white": [
        "初六：履霜，堅冰至。（白話：踩到霜，堅冰即將到來，要防微杜漸。）",
        "六二：直方大，不習無不利。（白話：正直、方正、廣大，不用特別學習也無往不利。）",
        "六三：含章可貞，或從王事，無成有終。（白話：內含美德可守正。跟隨君王做事，不居功但有好結局。）",
        "六四：括囊，無咎無譽。（白話：把口袋綁緊閉口，無過也無稱譽。）",
        "六五：黃裳元吉。（白話：穿黃色下裳，中正柔順，大吉。）",
        "上六：龍戰於野，其血玄黃。（白話：陰陽兩龍在野外爭戰，流出黑黃色的血。）"
      ]
    },
    {
      "id": 3,
      "name": "屯",
      "pinyin": "Zhun",
      "symbol": "坎上震下",
      "trigram_upper": 2,
      "trigram_lower": 1,
      "short": "水雷屯",
      "ci": "元亨利貞。勿用有攸往，利建侯。",
      "ci_white": "大吉大利，利於守正。暫時不要有所行動，有利於建立諸侯。",
      "yao_white": [
        "初九：磐桓，利居貞，利建侯。（白話：徘徊不前，宜安居守正，有利於建立諸侯。）",
        "六二：屯如邅如，乘馬班如。匪寇婚媾，女子貞不字，十年乃字。（白話：困難重重，馬匹徘徊不前。不是強盜，而是求婚。女子守正十年後才嫁。）",
        "六三：即鹿無虞，惟入於林中，君子幾不如舍，往吝。（白話：追鹿沒有嚮導，只會跑進樹林。君子見機，不如放棄，硬追有困難。）",
        "六四：乘馬班如，求婚媾，往吉，無不利。（白話：馬匹徘徊，求婚而去，大吉無不利。）",
        "九五：屯其膏，小貞吉，大貞凶。（白話：屯積肥膏，小事守正吉，大事守正凶。）",
        "上六：乘馬班如，泣血漣如。（白話：馬匹徘徊，哭得血淚交流。）"
      ]
    },
    {
      "id": 4,
      "name": "蒙",
      "pinyin": "Meng",
      "symbol": "艮上坎下",
      "trigram_upper": 4,
      "trigram_lower": 2,
      "short": "山水蒙",
      "ci": "亨。匪我求童蒙，童蒙求我。初筮告，再三瀆，瀆不告。利貞。",
      "ci_white": "通順。不是我求幼稚之人，而是幼稚之人來求我。第一次占卜我告訴他，再三輕慢就不告訴了。利於守正。",
      "yao_white": [
        "初六：發蒙，利用刑人，用說桎梏。以往吝。（白話：啟發蒙昧，用刑罰教育人，解除枷鎖，硬往前走有困難。）",
        "九二：包蒙吉。納婦吉。子克家。（白話：包容蒙昧吉。娶妻吉。兒子能治家。）",
        "六三：勿用取女，見金夫，不有躬。無攸利。（白話：不要娶這女子，見到有錢男人就失身，無利。）",
        "六四：困蒙，吝。（白話：被蒙昧困住，有困難。）",
        "六五：童蒙吉。（白話：像孩子一樣蒙昧反而吉。）",
        "上九：擊蒙，不利為寇，利禦寇。（白話：打擊蒙昧，不利於做強盜，有利於防禦敵。）"
      ]
    },
    {
      "id": 5,
      "name": "需",
      "pinyin": "Xu",
      "symbol": "坎上乾下",
      "trigram_upper": 2,
      "trigram_lower": 7,
      "short": "水天需",
      "ci": "有孚，光亨，貞吉。利涉大川。",
      "ci_white": "有誠信，光大通順，守正吉。利於渡大河。",
      "yao_white": [
        "初九：需于郊，利用恒，無咎。（白話：在郊外等待，有利於持久，無咎。）",
        "九二：需于沙，小有言，終吉。（白話：在沙灘上等待，稍有口舌，最後吉。）",
        "九三：需于泥，致寇至。（白話：在泥中等待，招來盜寇。）",
        "六四：需于血，出自穴。（白話：在血泊中等待，從洞穴出來。)",
        "九五：需于酒食，貞吉。（白話：等待酒食的時候，守正吉。）",
        "上六：入于穴，有不速之客三人來，敬之終吉。（白話：進入洞穴，有三位不請自來的客人，恭敬對待終吉。）"
      ]
    },
    {
      "id": 6,
      "name": "訟",
      "pinyin": "Song",
      "symbol": "乾上坎下",
      "trigram_upper": 7,
      "trigram_lower": 2,
      "short": "天水訟",
      "ci": "有孚窒惕，中吉，終凶。利見大人，不利涉大川。",
      "ci_white": "有誠信但被阻塞，要警惕，中途吉，終究凶。利見大人，不利渡大川。",
      "yao_white": [
        "初六：不永所事，小有言，終吉。（白話：不長久爭訟，小有口舌，終吉。）",
        "九二：不克訟，歸而逋，其邑人三百戶，無眚。（白話：打不贏官司，逃回老家，封地只剩三百戶，無大災。）",
        "六三：食舊德，貞厲，終吉，或從王事，無成。（白話：吃老本，守正雖危險，終吉。跟隨君王做事，無成功。）",
        "九四：不克訟，復即命，渝安貞，吉。（白話：打不贏官司，回來接受命令，改變態度守正，吉。）",
        "九五：訟，元吉。（白話：打官司，大吉。）",
        "上九：或錫之鞶帶，終朝三褫之。（白話：君王賞賜大腰帶，一早上被剝奪三次（勝訴後驕傲必失）。）"
      ]
    },
    {
      "id": 7,
      "name": "師",
      "pinyin": "Shi",
      "symbol": "坎上坤下",
      "trigram_upper": 2,
      "trigram_lower": 0,
      "short": "地水師",
      "ci": "貞丈人吉，无咎。",
      "ci_white": "守正，由德高望重的長者帶兵吉，無咎。",
      "yao_white": [        
        "初六：師出以律，貞凶，無咎。（白話：出兵要守紀律，否則凶。）",
        "九二：在師中吉，无咎，王三錫命。（白話：在軍中居中吉，無咎，君王多次賞賜。）",
        "六三：師或輿屍，凶。（白話：軍隊可能運屍而歸，凶。）",
        "六四：師左次，無咎。（白話：軍隊向左後方撤退，無咎。）",
        "六五：田有禽，利執言，無咎。長子帥師，弟子輿屍，貞凶。（白話：打獵有收穫，有利於聽取建議，無咎。長子帶兵吉，弟子帶兵則運屍而歸，凶。）",
        "上六：大君有命，開國承家，小人勿用。（白話：君王下令，分封諸侯與大夫，小人不得封賞。）"
      ]
    },
    {
      "id": 8,
      "name": "比",
      "pinyin": "Bi",
      "symbol": "坤上坎下",
      "trigram_upper": 0,
      "trigram_lower": 2,
      "short": "水地比",
      "ci": "吉。原筮元永貞,无咎。不寧方來，後夫凶。",
      "ci_white": "吉。初筮元始永遠正固，無咎。不安的遠方來歸附，遲來者凶。",
      "yao_white": [
        "初六：有孚比之，無咎。有孚盈缶，終來有它，吉。（白話：有誠信親比，無咎。誠信像滿缶一樣，最後有意外之喜，吉。）",
        "六二：比之自內，貞吉。（白話：從內心真誠親近，守正吉利。）",
        "六三：比之匪人。（白話：親近的不是好人。）",
        "六四：外比之，貞吉。（白話：向外真誠結交，守正吉利。）",
        "九五：顯比，王用三驅，失前禽，邑人不誡，吉。（白話：光明正大親比，君王用三面圍獵，放走前面的獵物，百姓不需警告，吉利。）",
        "上六：比之無首，凶。（白話：親比卻沒有領頭人，大凶。）"
      ]
    },
    {
      "id": 9,
      "name": "小畜",
      "pinyin": "Xiao Chu",
      "symbol": "巽上乾下",
      "trigram_upper": 6,
      "trigram_lower": 7,
      "short": "風天小畜",
      "ci": "亨。密雲不雨，自我西郊。",
      "ci_white": "亨通。密雲不雨，從我西方郊外而來。",
      "yao_white": [
        "初九：復自道，何其咎，吉。（白話：回歸正道，哪裡會有過錯？吉利。）",
        "九二：牽復，吉。（白話：被牽引回正道，吉利。）",
        "九三：輿說輻，夫妻反目。（白話：車輪脫落，夫妻爭吵。）",
        "六四：有孚，血去惕出，無咎。（白話：有誠信，傷口癒合，恐懼消除，無過錯。）",
        "九五：有孚攣如，富以其鄰。（白話：誠信緊密相連，與鄰居共享富足。）",
        "上九：既雨既處，尚德載，婦貞厲，月幾望，君子征凶。（白話：雨已下，雲已停，德行高尚；婦女守正有危險，月亮快滿了，君子出征有凶。）"
      ]
    },
    {
      "id": 10,
      "name": "履",
      "pinyin": "Lü",
      "symbol": "乾上兌下",
      "trigram_upper": 7,
      "trigram_lower": 3,
      "short": "天澤履",
      "ci": "履虎尾，不咥人，亨。",
      "ci_white": "踐虎尾，不咬人，亨通。",
      "yao_white": [
        "初九：素履往，无咎。（白話：腳踏實地，樸素前行，無過錯。）",
        "九二：履道坦坦，幽人貞吉。（白話：道路平坦，隱士守正吉利。）",
        "六三：眇能視，跛能履，履虎尾，咥人，凶。武人為于大君。（白話：瞎子能看，跛子能走，踩到虎尾，被咬，大凶。武人立志成為大君。）",
        "九四：履虎尾，愬愬，終吉。（白話：踩到虎尾，戰戰兢兢，最終吉利。）",
        "九五：夬履，貞厲。（白話：果斷行動，守正有危險。）",
        "上九：視履考祥，其旋元吉。（白話：回顧行為，檢討吉凶，迴旋調整，大吉大利。）"
      ]
    },
    {
      "id": 11,
      "name": "泰",
      "pinyin": "Tai",
      "symbol": "坤上乾下",
      "trigram_upper": 0,
      "trigram_lower": 7,
      "short": "地天泰",
      "ci": "小往大來，吉亨。",
      "ci_white": "小人離去，大人到來，吉祥通順。",
      "yao_white": [
        "初九：拔茅茹，以其彙，征吉。（白話：拔茅草連根拔起，結伴遠征吉。）",
        "九二：包荒，用馮河，不遐遺，朋亡，得尚于中行。（白話：包容荒蕪，徒步過河，不遺遠方，朋友離散，卻能與中正之人相合。）",
        "九三：無平不陂，無往不復。艱貞無咎，勿恤其孚，于食有福。（白話：沒有平地不變坡，沒有去而不回。艱難中守正無咎，不用擔心誠信，飲食有福。）",
        "六四：翩翩，不富以其鄰，不戒以孚。（白話：輕快飛舞，不靠財富而與鄰人相親，不用警告就真誠相待。）",
        "六五：帝乙歸妹，以輔顒真，吉。（白話：帝乙嫁女，用真誠輔佐，吉利。）",
        "上六：城復于隍，勿用師，自邑告命，貞吝。（白話：城牆倒塌到護城河，不要出兵，從城內下命令，守正仍有困難。）"
      ]
    },
    {
      "id": 12,
      "name": "否",
      "pinyin": "Pi",
      "symbol": "乾上坤下",
      "trigram_upper": 7,
      "trigram_lower": 0,
      "short": "天地否",
      "ci": "否之匪人，不利君子貞，大往小來。",
      "ci_white": "小人當道，貴人全跑光，君子越正直越吃虧，現在什麼事都卡死、卡住、推不動。",
      "yao_white": [
        "初六：拔茅茹，以其彙，貞吉亨。（白話：連根拔起茅草，與同類一起，守正吉利亨通。）",
        "六二：包承，小人吉，大人否，亨。（白話：包容奉承，小人吉利，大人閉塞，但仍亨通。）",
        "六三：包羞。（白話：包容羞辱。）",
        "九四：有命無咎，疇離祉。（白話：有天命，無過錯，同類共享福祉。）",
        "九五：休否，大人吉。其亡其亡，系于苞桑。（白話：停止閉塞，大人吉利。總是擔心滅亡，卻像繫在茂盛的桑樹上（根基穩固）。）",
        "上九：傾否，先否後喜。（白話：傾覆閉塞，先閉塞後喜悅。）"
      ]
    },
    {
      "id": 13,
      "name": "同人",
      "pinyin": "Tong Ren",
      "symbol": "乾上離下",
      "trigram_upper": 7,
      "trigram_lower": 5,
      "short": "天火同人",
      "ci": "同人於野，亨。利涉大川，利君子貞。",
      "ci_white": "與人同心於野外，亨通。有利渡大河，有利君子正固。",
      "yao_white": [
        "初九：同人于門，無咎。（白話：在門口與人同心，無過錯。）",
        "六二：同人于宗，吝。（白話：在宗族內結黨，有悔。）",
        "九三：伏戎于莽，升其高陵，三歲不興。（白話：藏兵於草叢，登上高崗，三年不發動。）",
        "九四：乘其墉，弗克攻，吉。（白話：登上城牆，無法攻克，退兵吉利。）",
        "九五：同人，先號咷而後笑，大師克相遇。（白話：同心之人，先哭後笑，大軍終於會師。）",
        "上九：同人于郊，無悔。（白話：在郊外與人同心，無悔。）"
      ]
    },
    {
      "id": 14,
      "name": "大有",
      "pinyin": "Da You",
      "symbol": "離上乾下",
      "trigram_upper": 5,
      "trigram_lower": 7,
      "short": "火天大有",
      "ci": "元亨。",
      "ci_white": "大吉大利。",
      "yao_white": [
        "初九：無交害，匪咎，艱則無咎。（白話：不與害人之人交往，不是過錯，艱難時守正無咎。）",
        "九二：大車以載，有攸往，無咎。（白話：用大車裝載，前進有去處，無過錯。）",
        "九三：公用亨于天子，小人弗克。（白話：公侯向天子獻祭，小人做不到。）",
        "九四：匪其彭，無咎。（白話：不炫耀奢華，無過錯。）",
        "六五：厥孚交如，威如，吉。（白話：誠信相互交融，威嚴自然，吉利。）",
        "上九：自天祐之，吉無不利。（白話：上天保佑，吉利無所不利。）"
      ]
    },
    {
      "id": 15,
      "name": "謙",
      "pinyin": "Qian",
      "symbol": "坤上艮下",
      "trigram_upper": 0,
      "trigram_lower": 4,
      "short": "地山謙",
      "ci": "亨，君子有終。",
      "ci_white": "亨通，君子有善終。",
      "yao_white": [
        "初六：謙謙君子，用涉大川，吉。（白話：謙虛再謙虛的君子，敢渡大河，吉。）",
        "六二：鳴謙，貞吉。（白話：謙虛名聲傳出，守正吉。）",
        "九三：勞謙君子，有終吉。（白話：勞苦而謙虛的君子，有善終，吉利。）",
        "六四：無不利，撝謙也。（白話：無所不利，發揚謙虛。）",
        "六五：不富以其鄰，利用侵伐，無不利。（白話：不靠財富而與鄰人相處，宜於征伐，無不利。）",
        "上六：鳴謙，利用行師，征邑國。（白話：謙虛之名傳揚，宜於出兵，征討城邑國家。）"
      ]
    },
    {
      "id": 16,
      "name": "豫",
      "pinyin": "Yu",
      "symbol": "震上坤下",
      "trigram_upper": 1,
      "trigram_lower": 0,
      "short": "雷地豫",
      "ci": "利建侯行師。",
      "ci_white": "有利建立諸侯，出師作戰。",
      "yao_white": [
        "初六：鳴豫，凶。（白話：自鳴得意，大凶。）",
        "六二：介于石，不終日，貞吉。（白話：夾在石頭中，不到一天就脫困，守正吉利。）",
        "六三：盱豫悔，遲有悔。（白話：仰視而喜悅必有悔恨，遲疑也有悔恨。）",
        "九四：由豫，大有得，勿疑，朋盍簪。（白話：因喜悅而得大收穫，勿懷疑，朋友聚集如簪。）",
        "六五：貞疾，恒不死。（白話：守正有病，但長久不死。）",
        "上六：冥豫成有渝，無咎。（白話：昏暗中喜悅，後來有所改變，無過錯。）"
      ]
    },
    {
      "id": 17,
      "name": "隨",
      "pinyin": "Sui",
      "symbol": "兌上震下",
      "trigram_upper": 3,
      "trigram_lower": 1,
      "short": "澤雷隨",
      "ci": "元亨利貞,无咎。",
      "ci_white": "元始亨通有利正固，無咎。",
      "yao_white": [
        "初九：官有渝，貞吉。出門交有功。（白話：官職有變，守正吉利。出門與人交往必有成就。）",
        "六二：系小子，失丈夫。（白話：依附小人，失去君子。）",
        "六三：系丈夫，失小子。隨有求得，利居貞。（白話：依附君子，失去小人。隨順有所求得，宜安居守正。）",
        "九四：隨有獲，貞凶。有孚在道，以明，何咎。（白話：隨順有所獲，守正有凶。有誠信走正道，以明辨，哪有過錯。）",
        "九五：孚于嘉，吉。（白話：誠信於美好之事，吉利。）",
        "上六：拘系之，乃從維之，王用亨于西山。（白話：被拘禁後，終於順從，王在西山祭祀。）"
      ]
    },
    {
      "id": 18,
      "name": "蠱",
      "pinyin": "Gu",
      "symbol": "巽上艮下",
      "trigram_upper": 6,
      "trigram_lower": 4,
      "short": "山風蠱",
      "ci": "元亨，利涉大川。先甲三日，後甲三日。",
      "ci_white": "大吉大利，宜於渡大河。事前三日（辛）、事後三日（丁）都要慎重。",
      "yao_white": [
        "初六：幹父之蠱，有子，考無咎，厲終吉。（白話：整治父親留下的亂局，有孝子，父親無過錯，危險中最終吉利。）",
        "九二：幹母之蠱，不可貞。（白話：整治母親留下的亂局，不可固守。）",
        "九三：幹父之蠱，小有悔，無大咎。（白話：整治父親的亂局，小有遺憾，無大過錯。）",
        "六四：裕父之蠱，往見吝。（白話：寬容父親的亂局，前進有悔。）",
        "六五：幹父之蠱，用譽。（白話：整治父親的亂局，獲得美譽。）",
        "上九：不事王侯，高尚其事。（白話：不侍奉王侯，志向高潔。）"
      ]
    },
    {
      "id": 19,
      "name": "臨",
      "pinyin": "Lin",
      "symbol": "坤上兌下",
      "trigram_upper": 0,
      "trigram_lower": 3,
      "short": "地澤臨",
      "ci": "元亨利貞。至於八月有凶。",
      "ci_white": "大吉大利，守正則吉。到了八月會有凶險。",
      "yao_white": [
        "初九：咸臨，貞吉。（白話：以感應之心臨事，守正吉利。）",
        "九二：咸臨，吉，無不利。（白話：以感應之心臨事，吉利，無不利。）",
        "六三：甘臨，無攸利。既憂之，無咎。（白話：用甜言蜜語臨事，無利。若能憂慮改正，無過錯。）",
        "六四：至臨，無咎。（白話：親自到達臨事，無過錯。）",
        "六五：知臨，大君之宜，吉。（白話：以智慧臨事，大君應有的做法，吉利。）",
        "上六：敦臨，吉，無咎。（白話：以厚道臨事，吉利，無過錯。）"
      ]
    },
    {
      "id": 20,
      "name": "觀",
      "pinyin": "Guan",
      "symbol": "巽上坤下",
      "trigram_upper": 6,
      "trigram_lower": 0,
      "short": "風地觀",
      "ci": "盥而不薦，有孚顒若。",
      "ci_white": "洗手而不獻祭，有誠信而莊嚴。",
      "yao_white": [
        "初六：童觀，小人無咎，君子之吝。（白話：像孩子一樣觀望，小人無咎，君子有悔。）",
        "六二：窺觀，利女貞。（白話：從門縫偷看，女子守正有利。）",
        "六三：觀我生，進退。（白話：觀察自己的處境，決定進退。）",
        "六四：觀國之光，利用賓于王。（白話：觀察國家的光輝，有利於做國王賓客。）",
        "九五：觀我生，君子无咎。（白話：觀察自己的一生，君子無咎。）",
        "上九：觀其生，君子無咎。（白話：觀察他人的一生，君子無咎。）"
      ]
    },
    {
      "id": 21,
      "name": "噬嗑",
      "pinyin": "Shi He",
      "symbol": "離上震下",
      "trigram_upper": 5,
      "trigram_lower": 1,
      "short": "火雷噬嗑",
      "ci": "亨。利用獄。",
      "ci_white": "亨通。有利於審判。",
      "yao_white": [
        "初九：屨校滅趾，無咎。（白話：腳戴木枷，傷到腳趾，無過錯。）",
        "六二：噬膚滅鼻，無咎。（白話：咬破皮膚，傷到鼻子，無過錯。）",
        "六三：噬腊肉，遇毒，小吝，無咎。（白話：咬臘肉，遇到毒，小有遺憾，無大過錯。）",
        "九四：噬乾胏，得金矢，利艱貞，吉。（白話：咬乾肉，得到金箭，宜艱難中守正，吉利。）",
        "六五：噬乾肉，得黃金，貞厲，無咎。（白話：咬乾肉，得到黃金，守正有危險，無過錯。）",
        "上九：何校滅耳，凶。（白話：頸戴重枷，傷到耳朵，大凶。）"
      ]
    },
    {
      "id": 22,
      "name": "賁",
      "pinyin": "Bi",
      "symbol": "艮上離下",
      "trigram_upper": 4,
      "trigram_lower": 5,
      "short": "山火賁",
      "ci": "亨。小利有攸往。",
      "ci_white": "通順。小事有利於行動。",
      "yao_white": [
        "初九：賁其趾，舍車而徒。（白話：裝飾腳趾，捨棄車子而步行。）",
        "六二：賁其須。（白話：裝飾鬍鬚。）",
        "九三：賁如濡如，永貞吉。（白話：華麗潤澤，長久守正吉利。）",
        "六四：賁如皤如，白馬翰如，匪寇婚媾。（白話：華麗潔白，白馬飛馳，不是強盜是求婚。）",
        "六五：賁于丘園，束帛戔戔，吝，終吉。（白話：在山丘園林中裝飾，絲帛雖少，終究吉利。）",
        "上九：白賁，無咎。（白話：純白裝飾，無過錯。）"
      ]
    },
    {
      "id": 23,
      "name": "剝",
      "pinyin": "Bo",
      "symbol": "艮上坤下",
      "trigram_upper": 4,
      "trigram_lower": 0,
      "short": "山地剝",
      "ci": "不利有攸往。",
      "ci_white": "不利於有所行動。",
      "yao_white": [
        "初六：剝床以足，蔑貞凶。（白話：床腳被剝蝕，毀壞正道，大凶。）",
        "六二：剝床以辨，蔑貞凶。（白話：床邊被剝蝕，毀壞正道，大凶。）",
        "六三：剝之，無咎。（白話：被剝蝕，無過錯。）",
        "六四：剝床以膚，凶。（白話：床面被剝蝕到皮膚，大凶。）",
        "六五：貫魚，以宮人寵，無不利。（白話：魚串在一起，宮女受寵，無不利。）",
        "上九：碩果不食，君子得輿，小人剝廬。（白話：大果實不被吃，君子得車，小人毀房。）"
      ]
    },
    {
      "id": 24,
      "name": "復",
      "pinyin": "Fu",
      "symbol": "坤上震下",
      "trigram_upper": 0,
      "trigram_lower": 1,
      "short": "地雷復",
      "ci": "亨。出入无疾，朋來无咎。反復其道，七日來復，利有攸往。",
      "ci_white": "通順。進出無病，朋友來無咎。反覆於正道，七日陽氣復來，宜有所行動。",
      "yao_white": [
        "初九：不遠復，無祇悔，元吉。（白話：走得不遠就回頭，沒有大悔，大吉大利。）",
        "六二：休復，吉。（白話：安然回歸，吉利。）",
        "六三：頻復，厲無咎。（白話：屢次回歸，危險但無過錯。）",
        "六四：中行獨復。（白話：走在中間，獨自回歸。）",
        "六五：敦復，無悔。（白話：厚道回歸，無悔。）",
        "上六：迷復，凶，有災眚。用行師，終有大敗，以其國君凶；至于十年不克征。（白話：迷失後回歸，大凶，有災難。用兵終大敗，連國君都危險；十年都不能出征。）"
      ]
    },
    {
      "id": 25,
      "name": "無妄",
      "pinyin": "Wu Wang",
      "symbol": "乾上震下",
      "trigram_upper": 7,
      "trigram_lower": 1,
      "short": "天雷無妄",
      "ci": "元亨利貞。其匪正有眚，不利有攸往。",
      "ci_white": "元始亨通有利正固。不正則有災，不宜行動。",
      "yao_white": [
        "初九：無妄，往吉。（白話：無妄之行，前進吉利。）",
        "六二：不耕獲，不菑畝，不菑，則所得有孚元吉。（白話：不耕種就收穫，不開墾就得田地，不開墾，則所得有誠信，大吉大利。）",
        "六三：無妄之災，或繩之牛，行人之得，邑人之災。（白話：無妄之災，有人拴住牛，路人撿到，城裡人遭殃。）",
        "九四：可貞，無咎。（白話：可以守正，無過錯。）",
        "九五：無妄之疾，勿藥有喜。（白話：無妄之病，不用藥也會痊癒。）",
        "上九：無妄，行有眚，無攸利。（白話：無妄之行，行動有災，無所利。）"
      ]
    },
    {
      "id": 26,
      "name": "大畜",
      "pinyin": "Da Chu",
      "symbol": "艮上乾下",
      "trigram_upper": 4,
      "trigram_lower": 7,
      "short": "山天大畜",
      "ci": "利貞。不家食吉，利涉大川。",
      "ci_white": "有利正固。不在家食吉，有利渡大河。",
      "yao_white": [
        "初九：有厲利已。（白話：有危險，宜停止。）",
        "九二：輿說輻。（白話：車輪脫落。）",
        "九三：良馬逐，利艱貞。曰閑輿衛，利有攸往。（白話：好馬追趕，宜艱難中守正。平日練習車馬防衛，則利於行動。）",
        "六四：童牛之牿，元吉。（白話：小牛戴角套，大吉大利。）",
        "六五：豶豕之牙吉。（白話：豬牙被控制，吉利。）",
        "上九：何天之衢，亨。（白話：承載天道，亨通。）"
      ]
    },
    {
      "id": 27,
      "name": "頤",
      "pinyin": "Yi",
      "symbol": "震上艮下",
      "trigram_upper": 1,
      "trigram_lower": 4,
      "short": "雷山頤",
      "ci": "貞吉。觀頤，自求口實。",
      "ci_white": "正固吉。觀其養生之道，自求口食。",
      "yao_white": [
        "初九：舍爾靈龜，觀我朵頤，凶。（白話：放棄你的靈龜，羨慕我大吃大喝，大凶。）",
        "六二：顛頤，拂經于丘頤，征凶。（白話：顛倒養生，違背常理去山上求食，出征有凶。）",
        "六三：拂頤，貞凶。十年勿用，無攸利。（白話：違背養生，守正有凶。十年都不能行動，無所利。）",
        "六四：顛頤，吉。虎視眈眈，其欲逐逐，無咎。（白話：顛倒養生卻吉利。像老虎盯著獵物，慾望強烈，無過錯。）",
        "六五：拂經，居貞吉，不可涉大川。（白話：違背常理，安居守正吉利，不可渡大河。）",
        "上九：由頤，厲吉，利涉大川。（白話：因養生而來，危險中吉利，有利渡大河。）"
      ]
    },
    {
      "id": 28,
      "name": "大過",
      "pinyin": "Da Guo",
      "symbol": "兌上巽下",
      "trigram_upper": 3,
      "trigram_lower": 6,
      "short": "澤風大過",
      "ci": "棟橈，利有攸往，亨。",
      "ci_white": "房樑彎曲（極端之象），宜有所行動，通順。",
      "yao_white": [
        "初六：藉用白茅，無咎。（白話：用白茅草墊底，無過錯。）",
        "九二：枯楊生稊，老夫得其女妻，無不利。（白話：枯楊發新芽，老夫娶少女，無不利。）",
        "九三：棟撓，厲。（白話：棟梁彎曲，危險。）",
        "九四：棟隆，吉，有它吝。（白話：棟梁隆起，吉利，若有他事則有悔。）",
        "九五：枯楊生華，老婦得其士夫，無咎無譽。（白話：枯楊開花，老婦嫁年輕丈夫，無過錯也無美譽。）",
        "上六：過涉滅頂，凶，無咎。（白話：過度涉水淹沒頭頂，大凶，但無過錯。）"
      ]
    },
    {
      "id": 29,
      "name": "坎",
      "pinyin": "Kan",
      "symbol": "坎上坎下",
      "trigram_upper": 2,
      "trigram_lower": 2,
      "short": "坎為水",
      "ci": "習坎。有孚，維心亨，行有尚。",
      "ci_white": "習於險中。有誠信，心亨通，行有功。",
      "yao_white": [
        "初六：習坎，入于坎窞，凶。（白話：習慣於險境，陷入深坑，大凶。）",
        "九二：坎有險，求小得。（白話：險境中有危險，求小收穫可得。）",
        "六三：來之坎坎，險且枕，入于坎窞，勿用。（白話：來來去去都是險，危險又阻礙，陷入深坑，不可行動。）",
        "六四：樽酒簋贰，用缶，納約自牖，終無咎。（白話：一樽酒、兩盤菜，用瓦缶，從窗戶遞進簡單契約，終無過錯。）",
        "九五：坎不盈，祗既平，無咎。（白話：水坑未滿，地面已平，無過錯。）",
        "上六：繫用徽纆，置于叢棘，三歲不得，凶。（白話：用繩索綁住，關在荊棘牢中，三年不得出，大凶。）"
      ]
    },
    {
      "id": 30,
      "name": "離",
      "pinyin": "Li",
      "symbol": "離上離下",
      "trigram_upper": 5,
      "trigram_lower": 5,
      "short": "離為火",
      "ci": "利貞，亨。畜牝牛吉。",
      "ci_white": "有利正固，亨通。養牝牛吉。",
      "yao_white": [
        "初九：履錯然，敬之無咎。（白話：腳步錯亂，恭敬對待，無過錯。）",
        "六二：黃離，元吉。（白話：黃色光芒，大吉大利。）",
        "九三：日昃之離，不鼓缶而歌，則大耋之嗟，凶。（白話：太陽西斜時的光芒，不敲缶唱歌，就會像老人嘆息，大凶。）",
        "九四：突如其來如，焚如，死如，棄如。（白話：突然來襲，焚燒、死亡、拋棄。）",
        "六五：出涕沱若，戚嗟若，吉。（白話：淚流滿面，悲傷嘆息，吉利。）",
        "上九：王用出征，有嘉折首，獲匪其丑，無咎。（白話：君王出兵，有功績斬首惡首，俘虜不是同類，無咎。）"
      ]
    },
    {
      "id": 31,
      "name": "咸",
      "pinyin": "Xian",
      "symbol": "兌上艮下",
      "trigram_upper": 3,
      "trigram_lower": 4,
      "short": "澤山咸",
      "ci": "亨，利貞，取女吉。",
      "ci_white": "亨通，有利正固，取女吉。",
      "yao_white": [
        "初六：咸其拇。（白話：感應在腳趾。）",
        "六二：咸其腓，凶，居吉。（白話：感應在小腿，凶，安居吉利。）",
        "九三：咸其股，執其隨，往吝。（白話：感應在大腿，執著於隨從，前進有悔。）",
        "九四：貞吉，悔亡。憧憧往來，朋從爾思。（白話：守正吉利，悔恨消失。來來往往，朋友順從你的想法。）",
        "九五：咸其脢，無悔。（白話：感應在背部，無悔。）",
        "上六：咸其輔，頰，舌。（白話：感應在臉頰和舌頭。）"
      ]
    },
    {
      "id": 32,
      "name": "恒",
      "pinyin": "Heng",
      "symbol": "巽上震下",
      "trigram_upper": 6,
      "trigram_lower": 1,
      "short": "雷風恒",
      "ci": "亨,无咎，利貞，利有攸往。",
      "ci_white": "亨通，無咎，有利正固，宜有所行動。",
      "yao_white": [
        "初六：浚恒，貞凶，無攸利。（白話：深挖恆久，守正有凶，無所利。）",
        "九二：悔亡。（白話：悔恨消失。）",
        "九三：不恒其德，或承之羞，貞吝。（白話：不能長久保持德行，有人因此受辱，守正也有困難。）",
        "九四：田无禽。（白話：田獵很久沒有收穫。）",
        "六五：恆其德，貞，婦人吉，夫子凶。（白話：長久保持德行，婦人吉，男子凶。）",
        "上六：振恒，凶。（白話：震動不寧於恆久，凶。）"
      ]
    },
    {
      "id": 33,
      "name": "遯",
      "pinyin": "Dun",
      "symbol": "乾上艮下",
      "trigram_upper": 7,
      "trigram_lower": 4,
      "short": "天山遯",
      "ci": "亨。小利貞。",
      "ci_white": "亨通。小有利正固。",
      "yao_white": [
        "初六：遯尾，厲，勿用有攸往。（白話：退隱在最後，危險，不要有所行動。）",
        "六二：執之用黃牛之革，莫之勝說。（白話：用黃牛皮牢牢綁住，誰也解不開。）",
        "九三：系遯，有疾厲，畜臣妾吉。（白話：被牽絆而退隱，有病危險，養臣妾則吉。）",
        "九四：好遯，君子吉，小人否。（白話：喜好退隱，君子吉利，小人閉塞。）",
        "九五：嘉遯，貞吉。（白話：美好的退隱，守正吉利。）",
        "上九：肥遯，無不利。（白話：遠離塵世，無所不利。）"
      ]
    },
    {
      "id": 34,
      "name": "大壯",
      "pinyin": "Da Zhuang",
      "symbol": "震上乾下",
      "trigram_upper": 1,
      "trigram_lower": 7,
      "short": "雷天大壯",
      "ci": "利貞。",
      "ci_white": "有利正固。",
      "yao_white": [
        "初九：壯于趾，征凶，有孚。（白話：強壯在腳趾，出征有凶，有誠信。）",
        "九二：貞吉。（白話：守正吉利。）",
        "九三：小人用壯，君子用罔，貞厲。羝羊觸藩，羸其角。（白話：小人逞強，君子無為，守正有危險。公羊撞籬笆，角被卡住。）",
        "九四：貞吉悔亡，藩決不羸，壯于大輿之輹。（白話：守正吉利悔恨消失，籬笆破開不卡角，強壯如大車的車軸。）",
        "六五：喪羊于易，無悔。（白話：在邊界丟失羊，無悔。）",
        "上六：羝羊觸藩，不能退，不能遂，無攸利，艱則吉。（白話：公羊撞籬笆，進退不得，無所利，艱難中守正則吉。）"
      ]
    },
    {
      "id": 35,
      "name": "晉",
      "pinyin": "Jin",
      "symbol": "離上坤下",
      "trigram_upper": 5,
      "trigram_lower": 0,
      "short": "火地晉",
      "ci": "康侯用錫馬蕃庶，晝日三接。",
      "ci_white": "晉升的諸侯得到賞賜許多馬匹，一天之內三次覲見君王。",
      "yao_white": [
        "初六：晉如摧如，貞吉。罔孚，裕無咎。（白話：前進受挫，守正吉利。無誠信，寬容無過錯。）",
        "六二：晉如愁如，貞吉。受茲介福，于其王母。（白話：前進憂愁，守正吉利。接受大福，從祖母而來。）",
        "六三：眾允，悔亡。（白話：眾人信服，悔恨消失。）",
        "九四：晉如鼫鼠，貞厲。（白話：前進如偷食的老鼠，守正有危險。）",
        "六五：悔亡，失得勿恤，往吉，無不利。（白話：悔恨消失，失得勿憂，前進吉利，無不利。）",
        "上九：晉其角，維用伐邑，厲吉無咎，貞吝。（白話：前進到極點，只能攻城，危險中吉利無過錯，守正有悔。）"
      ]
    },
    {
      "id": 36,
      "name": "明夷",
      "pinyin": "Ming Yi",
      "symbol": "坤上離下",
      "trigram_upper": 0,
      "trigram_lower": 5,
      "short": "地火明夷",
      "ci": "利艱貞。",
      "ci_white": "有利於艱難中正固。",
      "yao_white": [
        "初九：明夷于飛，垂其翼。君子于行，三日不食。有攸往，主人有言。（白話：光明受傷於飛行，垂下翅膀。君子出行，三天不吃飯。有去處，主人有話說。）",
        "六二：明夷，夷于左股，用拯馬壯，吉。（白話：光明受傷，傷在左腿，用強壯的馬救援，吉利。）",
        "九三：明夷于南狩，得其大首，不可疾貞。（白話：光明受傷於南方打獵，捕獲大頭目，不可急於守正。）",
        "六四：入于左腹，獲明夷之心，于出門庭。（白話：進入左腹，獲得光明受傷的心，在出門時。）",
        "六五：箕子之明夷，利貞。（白話：箕子光明受傷，利守正。）",
        "上六：不明晦，初登于天，後入于地。（白話：不光明而昏暗，起初升上天，後來陷入地。）"
      ]
    },
    {
      "id": 37,
      "name": "家人",
      "pinyin": "Jia Ren",
      "symbol": "巽上離下",
      "trigram_upper": 6,
      "trigram_lower": 5,
      "short": "風火家人",
      "ci": "利女貞。",
      "ci_white": "有利婦女正固。",
      "yao_white": [
        "初九：閑有家，悔亡。（白話：防範於家，悔恨消失。）",
        "六二：無攸遂，在中饋，貞吉。（白話：不任意妄為，在廚房掌管飲食，守正吉利。）",
        "九三：家人嗃嗃，悔厲吉；婦子嘻嘻，終吝。（白話：家人嚴厲，悔恨危險但吉利；婦女孩子嬉笑，終有遺憾。）",
        "六四：富家，大吉。（白話：家庭富裕，大吉大利。）",
        "九五：王假有家，勿恤，吉。（白話：君王治理家庭，勿憂，吉利。）",
        "上九：有孚威如，終吉。（白話：有誠信且威嚴，終究吉利。）"
      ]
    },
    {
      "id": 38,
      "name": "睽",
      "pinyin": "Kui",
      "symbol": "離上兌下",
      "trigram_upper": 5,
      "trigram_lower": 3,
      "short": "火澤睽",
      "ci": "小事吉。",
      "ci_white": "小事吉。",
      "yao_white": [
        "初九：悔亡，喪馬勿逐，自復，見惡人無咎。（白話：悔恨消失，丟馬勿追，會自己回來，見惡人無過錯。）",
        "九二：遇主于巷，無咎。（白話：在巷子遇見主人，無過錯。）",
        "六三：見輿曳，其牛掣，其人天且劓，無初有終。（白話：見車被拉，牛被牽制，人額頭刺字鼻被割，無好開端有好結束。）",
        "九四：睽孤，遇元夫，交孚，厲無咎。（白話：孤立分離，遇見正直之人，相互誠信，危險中無過錯。）",
        "六五：悔亡，厥宗噬膚，往何咎。（白話：悔恨消失，同宗咬破皮膚，前進有何過錯。）",
        "上九：睽孤見豕負塗，載鬼一車，先張之弧，後說之弧，匪寇婚媾，往遇雨則吉。（白話：孤立見豬背泥，載鬼一車，先拉弓後放箭，不是強盜是求婚，前進遇雨則吉。）"
      ]
    },
    {
      "id": 39,
      "name": "蹇",
      "pinyin": "Jian",
      "symbol": "坎上艮下",
      "trigram_upper": 2,
      "trigram_lower": 4,
      "short": "水山蹇",
      "ci": "利西南，不利東北。利見大人，貞吉。",
      "ci_white": "利西南，不利東北。有利見大人，正固吉。",
      "yao_white": [
        "初六：往蹇來譽。（白話：前進困難，回來得美譽。）",
        "六二：王臣蹇蹇，匪躬之故。（白話：王臣屢次艱難，不是為了自身。）",
        "九三：往蹇來反。（白話：前進困難，回來反而好。）",
        "六四：往蹇來連。（白話：前進困難，回來結伴。）",
        "九五：大蹇朋來。（白話：大困難，朋友來幫。）",
        "上六：往蹇來碩，吉，利見大人。（白話：前進困難，回來大吉，利見大人。）"
      ]
    },
    {
      "id": 40,
      "name": "解",
      "pinyin": "Xie",
      "symbol": "震上坎下",
      "trigram_upper": 1,
      "trigram_lower": 2,
      "short": "雷水解",
      "ci": "利西南，无所往，其來復吉。有攸往，夙吉。",
      "ci_white": "利西南，無所往，來歸復吉。有所往，早吉。",
      "yao_white": [
        "初六：無咎。（白話：無過錯。）",
        "九二：田獲三狐，得黃矢，貞吉。（白話：打獵捕三狐，得黃箭，守正吉利。）",
        "六三：負且乘，致寇至，貞吝。（白話：背負重物卻乘車，招來盜寇，守正有悔。）",
        "九四：解而拇，朋至斯孚。（白話：解開腳拇，朋友來此誠信相待。）",
        "六五：君子維有解，吉，有孚于小人。（白話：君子有解脫，吉利，對小人有誠信。）",
        "上六：公用射隼于高墉之上，獲之，無不利。（白話：公爵在高牆上射鷹，射中，無不利。）"
      ]
    },
    {
      "id": 41,
      "name": "損",
      "pinyin": "Sun",
      "symbol": "艮上兌下",
      "trigram_upper": 4,
      "trigram_lower": 3,
      "short": "山澤損",
      "ci": "有孚，元吉,无咎，可貞，利有攸往。曷之用，二簋可用享。",
      "ci_white": "有誠信，大吉無咎，可守正，宜行動。何必用豐盛祭品，兩碗飯就可祭祀。",
      "yao_white": [
        "初九：已事遄往，無咎，酌損之。（白話：事已完成，迅速前進，無過錯，適當減少。）",
        "九二：利貞，徵凶，弗損益之。（白話：利守正，出征有凶，不減少也不增加。）",
        "六三：三人行，則損一人；一人行，則得其友。（白話：三人同行，損失一人；一人獨行，則得朋友。）",
        "六四：損其疾，使遄有喜，無咎。（白話：減少疾病，迅速有喜，無過錯。）",
        "六五：或益之十朋之龜，弗克違，元吉。（白話：有人贈送價值十朋的大龜，不能拒絕，大吉。）",
        "上九：弗損益之，無咎，貞吉，利有攸往，得臣無家。（白話：不減少也不增加，無過錯，守正吉利，宜行動，得臣子無家室。）"
      ]
    },
    {
      "id": 42,
      "name": "益",
      "pinyin": "Yi",
      "symbol": "巽上震下",
      "trigram_upper": 6,
      "trigram_lower": 1,
      "short": "風雷益",
      "ci": "利有攸往，利涉大川。",
      "ci_white": "宜有所行動，有利渡大河。",
      "yao_white": [
        "初九：利用為大作，元吉，無咎。（白話：有利於做大事，大吉，無過錯。）",
        "六二：或益之十朋之龜，弗克違，永貞吉。王用享於帝，吉。（白話：有人贈送大龜，不能拒絕，長久守正吉。君王用來祭祀天帝，吉。）",
        "六三：益之用凶事，無咎。有孚中行，告公用圭。（白話：增加用於凶事，無過錯。有誠信走中道，稟告公侯用玉圭。）",
        "六四：中行，告公從，利用為依遷國。（白話：走中道，稟告公侯聽從，有利於依附遷移國家。）",
        "九五：有孚惠心，勿問元吉，有孚惠我德。（白話：有誠信惠及人心，勿問大吉，有誠信惠及我德。）",
        "上九：莫益之，或擊之，立心勿恆，凶。（白話：沒人增加，反而攻擊，立心不持久，凶。）"
      ]
    },
    {
      "id": 43,
      "name": "夬",
      "pinyin": "Guai",
      "symbol": "兌上乾下",
      "trigram_upper": 3,
      "trigram_lower": 7,
      "short": "澤天夬",
      "ci": "揚于王庭，孚號有厲，告自邑，不利即戎，利有攸往。",
      "ci_white": "揚於王庭，有誠信呼號有危，告知邑中，不利即用兵，宜有所行動。",
      "yao_white": [
        "初九：壯于前趾，往不勝為咎。（白話：強壯在腳趾，前進不能勝有困難。）",
        "九二：惕號，莫夜有戎，勿恤。（白話：驚呼，深夜有敵兵，勿憂。）",
        "九三：壯于頄，有凶。君子夬夬獨行，遇雨若濡，有愠無咎。（白話：強壯在臉頰，有凶。君子果斷獨行，遇雨濕身，有怒氣無過錯。）",
        "九四：臀無膚，其行次且，牽羊悔亡，聞言不信。（白話：臀部無皮，行走困難，牽羊悔恨消失，聽到話不信。）",
        "九五：莧陸夬夬，中行無咎。（白話：莧菜陸地果斷，中道無過錯。）",
        "上六：無號，終有凶。（白話：無呼號，終有凶。）"
      ]
    },
    {
      "id": 44,
      "name": "姤",
      "pinyin": "Gou",
      "symbol": "巽上乾下",
      "trigram_upper": 6,
      "trigram_lower": 7,
      "short": "天風姤",
      "ci": "女壯，勿用取女。",
      "ci_white": "女子強壯，不要娶這樣的女子。",
      "yao_white": [
        "初六：系于金柅，貞吉。有攸往、見凶，羸豕孚蹢。（白話：繫在金屬剎車上，守正吉利。有所往見凶，瘦豬誠信蹢躅。）",
        "九二：包有魚，無咎，不利賓。（白話：包裹有魚，無過錯，不利於賓客。）",
        "九三：臀无膚，其行次且，厲，无大咎。（白話：臀部無皮，行走困難，危險，無大咎。）",
        "九四：包無魚，起凶。（白話：包裹無魚，引起凶。）",
        "九五：以杞包瓜，含章，有隕自天。（白話：用杞柳包裹瓜，含藏美德，有東西從天而降。）",
        "上九：姤其角，吝，無咎。（白話：相遇於角，有悔，無過錯。）"
      ]
    },
    {
      "id": 45,
      "name": "萃",
      "pinyin": "Cui",
      "symbol": "兌上坤下",
      "trigram_upper": 3,
      "trigram_lower": 0,
      "short": "澤地萃",
      "ci": "亨。王假有廟，利見大人，亨，利貞。用大牲吉，利有攸往。",
      "ci_white": "亨通。君王到達宗廟，有利見大人，亨通，有利正固。用大牲祭祀吉，宜行動。",
      "yao_white": [
        "初六：有孚不終，乃亂乃萃，若號，一握為笑，勿恤，往無咎。（白話：有誠信不終，混亂中聚集，有人呼號，一把握手成笑，勿憂，前進無過錯。）",
        "六二：引吉，無咎，孚乃利用禴。（白話：引導吉利，無過錯，誠信可用薄祭。）",
        "六三：萃如嗟如，無攸利，往無咎，小吝。（白話：聚集嘆息，無所利，前進無過錯，小有遺憾。）",
        "九四：大吉，無咎。（白話：大吉，無過錯。）",
        "九五：萃有位，無咎，匪孚元永貞，悔亡。（白話：聚集有地位，無過錯，非誠信元始長久守正，悔恨消失。）",
        "上六：齎咨涕洟，無咎。（白話：嘆息流涕，無過錯。）"
      ]
    },
    {
      "id": 46,
      "name": "升",
      "pinyin": "Sheng",
      "symbol": "坤上巽下",
      "trigram_upper": 0,
      "trigram_lower": 6,
      "short": "地風升",
      "ci": "元亨，用見大人，勿恤，南征吉。",
      "ci_white": "元始亨通，用見大人，勿憂，南征吉。",
      "yao_white": [
        "初六：允升，大吉。（白話：允許上升，大吉大利。）",
        "九二：孚乃利用禴，無咎。（白話：誠信可用薄祭，無過錯。）",
        "九三：升虛邑。（白話：上升到空城。）",
        "六四：王用亨于岐山，吉，無咎。（白話：君王在岐山祭祀，吉利，無過錯。）",
        "六五：貞吉升階。（白話：守正吉利，步步高升。）",
        "上六：冥升，利于不息之貞。（白話：昏暗中上升，利於不停息的守正。）"
      ]
    },
    {
      "id": 47,
      "name": "困",
      "pinyin": "Kun",
      "symbol": "兌上坎下",
      "trigram_upper": 3,
      "trigram_lower": 2,
      "short": "澤水困",
      "ci": "亨，貞，大人吉，无咎。有言不信。",
      "ci_white": "亨通，正固，大人吉，無咎。有話不被相信。",
      "yao_white": [
        "初六：臀困于株木，入于幽谷，三歲不覿。（白話：臀部被樹樁卡住，進入幽谷，三年不見人。）",
        "九二：困于酒食，朱紱方來，利用享祀，征凶，無咎。（白話：困於酒食，朱紱將至，宜於祭祀，出征有凶，無過錯。）",
        "六三：困于石，據于蒺藜，入于其宮，不見其妻，凶。（白話：困於石頭，靠在蒺藜上，進入家門不見妻子，大凶。）",
        "九四：來徐徐，困于金車，吝，有終。（白話：慢慢前來，困於金車，有悔，有好結局。）",
        "九五：劓刖，困于赤紱，乃徐有說，利用祭祀。（白話：割鼻斷足，困於赤紱，慢慢解脫，宜於祭祀。）",
        "上六：困于葛藟，于臲卼，曰動悔，有悔，征吉。（白話：困於葛藤，在不穩之處，說行動有悔，有悔，出征吉利。）"
      ]
    },
    {
      "id": 48,
      "name": "井",
      "pinyin": "Jing",
      "symbol": "坎上巽下",
      "trigram_upper": 2,
      "trigram_lower": 6,
      "short": "水風井",
      "ci": "改邑不改井,无喪无得，往來井井。汔至亦未繘井，羸其瓶，凶。",
      "ci_white": "改邑不改井，無喪無得，往來井井。快到井卻沒繩子打水，瓶子漏了，凶。",
      "yao_white": [
        "初六：井泥不食，舊井無禽。（白話：井底泥濘不能喝，舊井無鳥來。）",
        "九二：井谷射鮒，瓮敝漏。（白話：井邊射小魚，瓦罐破漏。）",
        "九三：井渫不食，為我心恻，可用汲，王明，並受其福。（白話：井水清澈卻不喝，讓我心痛，可用來打水，君王英明，一起受福。）",
        "六四：井甃，無咎。（白話：修井砌磚，無過錯。）",
        "九五：井洌冷泉食。（白話：井水清冽如冷泉，可飲用。）",
        "上六：井收勿幕，有孚元吉。（白話：井水收成勿蓋，有誠信大吉大利。）"
      ]
    },
    {
      "id": 49,
      "name": "革",
      "pinyin": "Ge",
      "symbol": "兌上離下",
      "trigram_upper": 3,
      "trigram_lower": 5,
      "short": "澤火革",
      "ci": "己日乃孚，元亨利貞，悔亡。",
      "ci_white": "在己日獲得信任，大吉大利，守正則吉，悔恨消失。",
      "yao_white": [
        "初九：鞏用黃牛之革。（白話：用黃牛皮牢牢鞏固（不可輕動））",
        "六二：己日乃革之，征吉，無咎。（白話：己日進行變革，出征吉利，無過錯。）",
        "九三：征凶，貞厲，革言三就，有孚。（白話：前進凶，守正危險，變革的話三次達成，才有誠信。）",
        "九四：悔亡，有孚改命，吉。（白話：悔恨消失，有誠信改命，吉利。）",
        "九五：大人虎變，未占有孚。（白話：大人如虎變色，未占卜就有誠信。）",
        "上六：君子豹變，小人革面，征凶，居貞吉。（白話：君子如豹變色，小人改變面貌，出征有凶，安居守正吉利。）"
      ]
    },
    {
      "id": 50,
      "name": "鼎",
      "pinyin": "Ding",
      "symbol": "離上巽下",
      "trigram_upper": 5,
      "trigram_lower": 6,
      "short": "火風鼎",
      "ci": "元吉，亨。",
      "ci_white": "元吉，亨通。",
      "yao_white": [
        "初六：鼎顛趾，利出否，得妾以其子，無咎。（白話：鼎足倒立，有利於除去壞東西，得妾因其子，無過錯。）",
        "九二：鼎有實，我仇有疾，不我能即，吉。（白話：鼎中有食物，我的仇人有病，不能接近我，吉利。）",
        "九三：鼎耳革，其行塞，雉膏不食，方雨虧悔，終吉。（白話：鼎耳改變，行動受阻，雉鳥的脂肪不能吃，將要下雨減少悔恨，最後吉。）",
        "九四：鼎折足，覆公餗，其形渥，凶。（白話：鼎折斷腳，翻倒公侯的食物，形體狼狽，大凶。）",
        "六五：鼎黃耳金鉉，利貞。（白話：鼎有黃耳金鉉，利守正。）",
        "上九：鼎玉鉉，大吉，無不利。（白話：鼎有玉鉉，大吉，無不利。）"
      ]
    },
    {
      "id": 51,
      "name": "震",
      "pinyin": "Zhen",
      "symbol": "震上震下",
      "trigram_upper": 1,
      "trigram_lower": 1,
      "short": "震為雷",
      "ci": "亨。震來虩虩，笑言啞啞。震驚百里，不喪匕鬯。",
      "ci_white": "通順。震動來時恐懼，之後笑語啞啞，震驚百里，却不丟失勺子和酒器。",
      "yao_white": [
        "初九：震來虩虩，後笑言啞啞，吉。（白話：雷震驚恐，後來笑語啞啞，吉利。）",
        "六二：震來厲，億喪貝，躋于九陵，勿逐，七日得。（白話：雷震危險，損失大量財寶，登上九座山陵，勿追，七日後得回。）",
        "六三：震蘇蘇，震行無眚。（白話：雷震戰慄，行動無災。）",
        "九四：震遂泥。（白話：震動陷入泥中。）",
        "六五：震往來厲，億無喪，有事。（白話：震動往來危險，雖有損失但有大事可為。）",
        "上六：震索索，視矍矍，征凶。震不于其躬，于其鄰，無咎。婚媾有言。（白話：雷震繩索般顫抖，視線驚惶，出征有凶。雷不擊自身，擊中鄰人，無過錯。婚事有爭言。）"
      ]
    },
    {
      "id": 52,
      "name": "艮",
      "pinyin": "Gen",
      "symbol": "艮上艮下",
      "trigram_upper": 4,
      "trigram_lower": 4,
      "short": "艮為山",
      "ci": "艮其背，不獲其身，行其庭，不見其人，无咎。",
      "ci_white": "止於背後，不見自身，走在庭院不見他人，無咎。",
      "yao_white": [
        "初六：艮其趾，無咎，利永貞。（白話：停止腳步，無過錯，利長久守正。）",
        "六二：艮其腓，不拯其隨，其心不快。（白話：停止小腿，不救其隨從，心裡不快。）",
        "九三：艮其限，與其夤，厲薰心。（白話：停止腰部，割裂脊肉，危險熏心。）",
        "六四：艮其身，無咎。（白話：停止身體，無過錯。）",
        "六五：艮其輔，言有序，悔亡。（白話：停止嘴脣，言語有條理，悔恨消失。）",
        "上九：敦艮，吉。（白話：厚實停止，吉利。）"
      ]
    },
    {
      "id": 53,
      "name": "漸",
      "pinyin": "Jian",
      "symbol": "巽上艮下",
      "trigram_upper": 6,
      "trigram_lower": 4,
      "short": "風山漸",
      "ci": "女歸吉，利貞。",
      "ci_white": "女子歸嫁吉，有利正固。",
      "yao_white": [
        "初六：鴻漸于干，小子厲有言。（白話：大雁漸進到水邊，小孩危險有爭言。）",
        "六二：鴻漸于磐，飲食衎衎，吉。（白話：大雁漸進到磐石，飲食和樂，吉利。）",
        "九三：鴻漸于陸，夫征不復，婦孕不育，凶。利禦寇。（白話：大雁漸進到陸地，丈夫出征不歸，婦女懷孕不育，大凶。利於防禦盜寇。）",
        "六四：鴻漸于木，或得其桷，無咎。（白話：大雁漸進到樹上，或許棲於平枝，無過錯。）",
        "九五：鴻漸于陵，婦三歲不孕，終莫之勝說，吉。（白話：大雁漸進到山陵，婦女三年不孕，終究無人能勝過，吉利。）",
        "上九：鴻漸于陸，其羽可用為儀，吉。（白話：大雁漸進到陸地，其羽可用於儀式，吉利。）"
      ]
    },
    {
      "id": 54,
      "name": "歸妹",
      "pinyin": "Gui Mei",
      "symbol": "兌上震下",
      "trigram_upper": 3,
      "trigram_lower": 1,
      "short": "雷澤歸妹",
      "ci": "征凶，无攸利。",
      "ci_white": "征伐凶，無所利。",
      "yao_white": [
        "初九：歸妹以娣，跛能履，征吉。（白話：嫁女以妹妹為陪嫁，跛子能走，前進吉。）",
        "九二：眇能視，利幽人之貞。（白話：瞎子能看，利於隱士守正。）",
        "六三：歸妹以須，反歸以娣。（白話：嫁女以侍女，反被以妹妹嫁回。）",
        "九四：歸妹愆期，遲歸有時。（白話：嫁女錯過時機，遲嫁有時機。）",
        "六五：帝乙歸妹，其君之袂，不如其娣之袂良，月幾望，吉。（白話：帝乙嫁女，其君之袖不如妹妹之袖華美，月亮快滿，吉利。）",
        "上六：女承筐無實，士刲羊無血，無攸利。（白話：女子捧籃無物，男子宰羊無血，無所利。）"
      ]
    },
    {
      "id": 55,
      "name": "豐",
      "pinyin": "Feng",
      "symbol": "離上震下",
      "trigram_upper": 5,
      "trigram_lower": 1,
      "short": "雷火豐",
      "ci": "亨，王假之，勿憂，宜日中。",
      "ci_white": "通順，君王到達，不要憂慮，宜於日正中時。",
      "yao_white": [
        "初九：遇其配主，雖旬無咎，往有尚。（白話：遇見匹配的主人，即使十日無過錯，前進有功。）",
        "六二：豐其蔀，日中見斗，往得疑疾，有孚發若，吉。（白話：豐盛的遮蔽，日中見北斗，前進得疑病，有誠信發揚，吉利。）",
        "九三：豐其沛，日中見沫，折其右肱，無咎。（白話：豐盛的遮蔽，日中見小星，折斷右臂，無過錯。）",
        "九四：豐其蔀，日中見斗，遇其夷主，吉。（白話：豐盛的遮蔽，日中見北斗，遇見平等的主人，吉利。）",
        "六五：來章，有慶譽，吉。（白話：來有美德，有慶賀美譽，吉利。）",
        "上六：豐其屋，蔀其家，窺其戶，闃其無人，三歲不覿，凶。（白話：豐盛其屋，遮蔽其家，窺視其戶，寂靜無人，三年不見，大凶。）"
      ]
    },
    {
      "id": 56,
      "name": "旅",
      "pinyin": "Lü",
      "symbol": "艮上離下",
      "trigram_upper": 4,
      "trigram_lower": 5,
      "short": "火山旅",
      "ci": "小亨，旅貞吉。",
      "ci_white": "小亨通，旅人正固吉。",
      "yao_white": [
        "初六：旅瑣瑣，斯其所取災。（白話：旅途中瑣碎，招致災難。）",
        "六二：旅即次，懷其資，得童僕貞。（白話：旅途中停留，懷藏財資，得童僕守正。）",
        "九三：旅焚其次，喪其童僕，貞厲。（白話：旅途中燒毀住處，喪失童僕，守正有危險。）",
        "九四：旅于處，得其資斧，我心不快。（白話：旅途中安處，得財資斧，心裡不快。）",
        "六五：射雉一矢亡，終以譽命。（白話：射雉失去一箭，最後得稱譽命令。）",
        "上九：鳥焚其巢，旅人先笑後號咷，喪牛于易，凶。（白話：鳥巢被燒，旅人先笑後哭，於邊界喪牛，大凶。）"
      ]
    },
    {
      "id": 57,
      "name": "巽",
      "pinyin": "Xun",
      "symbol": "巽上巽下",
      "trigram_upper": 6,
      "trigram_lower": 6,
      "short": "巽為風",
      "ci": "小亨，利有攸往，利見大人。",
      "ci_white": "小亨通，宜行動，有利見大人。",
      "yao_white": [
        "初六：進退，利武人之貞。（白話：進退不定，利於武人守正。）",
        "九二：巽在床下，用史巫紛若，吉，無咎。（白話：順從在床下，用史巫紛然，吉利，無過錯。）",
        "九三：頻巽，吝。（白話：屢次順從，有困難。）",
        "六四：悔亡，田獲三品。（白話：悔恨消失，打獵獲三種獵物。）",
        "九五：貞吉悔亡，無不利，無初有終。先庚三日，後庚三日，吉。（白話：守正吉利悔恨消失，無不利，無好開端有好結束。先庚三日，後庚三日，吉利。）",
        "上九：巽在床下，喪其資斧，貞凶。（白話：順從在床下，喪失財資斧，守正有凶。）"
      ]
    },
    {
      "id": 58,
      "name": "兌",
      "pinyin": "Dui",
      "symbol": "兌上兌下",
      "trigram_upper": 3,
      "trigram_lower": 3,
      "short": "兌為澤",
      "ci": "亨，利貞。",
      "ci_white": "亨通，有利正固。",
      "yao_white": [
        "初九：和兌，吉。（白話：和諧喜悅，吉利。）",
        "九二：孚兌，吉，悔亡。（白話：誠信喜悅，吉利，悔恨消失。）",
        "六三：來兌，凶。（白話：前來喜悅，大凶。）",
        "九四：商兌，未寧，介疾有喜。（白話：商議喜悅，未安寧，隔絕小病有喜。）",
        "九五：孚于剝，有厲。（白話：誠信於剝削，有危險。）",
        "上六：引兌。（白話：引導喜悅。）"
      ]
    },
    {
      "id": 59,
      "name": "渙",
      "pinyin": "Huan",
      "symbol": "巽上坎下",
      "trigram_upper": 6,
      "trigram_lower": 2,
      "short": "風水渙",
      "ci": "亨。王假有廟，利涉大川，利貞。",
      "ci_white": "亨通。君王到宗廟，有利渡大河，有利正固。",
      "yao_white": [
        "初六：用拯馬壯，吉。（白話：用強壯的馬救援，吉利。）",
        "九二：渙奔其機，悔亡。（白話：渙散奔向機栝，悔恨消失。）",
        "六三：渙其躬，無悔。（白話：渙散其身，無悔。）",
        "六四：渙其群，元吉。渙有丘，匪夷所思。（白話：渙散其群，大吉。渙散成丘陵，非常人所能想。）",
        "九五：渙汗其大號，渙王居，無咎。（白話：渙散如大汗其號令，渙散王居，無過錯。）",
        "上九：渙其血，去逖出，無咎。（白話：渙散其血，遠去而出，無過錯。）"
      ]
    },
    {
      "id": 60,
      "name": "節",
      "pinyin": "Jie",
      "symbol": "坎上兌下",
      "trigram_upper": 2,
      "trigram_lower": 3,
      "short": "水澤節",
      "ci": "亨。苦節不可貞。",
      "ci_white": "亨通。苦節不可正固。",
      "yao_white": [
        "初九：不出戶庭，無咎。（白話：不出家門庭院，無過錯。）",
        "九二：不出門庭，凶。（白話：不出大門庭院，大凶。）",
        "六三：不節若，則嗟若，無咎。（白話：不節制則嘆息，無過錯。）",
        "六四：安節，亨。（白話：安於節制，亨通。）",
        "九五：甘節，吉，往有尚。（白話：甘願節制，吉利，前進有功。）",
        "上六：苦節，貞凶，悔亡。（白話：痛苦節制，守正有凶，悔恨消失。）"
      ]
    },
    {
      "id": 61,
      "name": "中孚",
      "pinyin": "Zhong Fu",
      "symbol": "巽上兌下",
      "trigram_upper": 6,
      "trigram_lower": 3,
      "short": "風澤中孚",
      "ci": "豚魚吉，利涉大川，利貞。",
      "ci_white": "豚魚吉，有利渡大河，有利正固。",
      "yao_white": [
        "初九：虞吉，有他不燕。（白話：安虞吉利，有他事不寧。）",
        "九二：鳴鶴在陰，其子和之。我有好爵，吾與爾靡之。（白話：鶴鳴於陰，其子應和。我有美酒，與你共飲。）",
        "六三：得敵，或鼓或罷，或泣或歌。（白話：得敵人，或擊鼓或停戰，或哭泣或唱歌。）",
        "六四：月幾望，馬匹亡，無咎。（白話：月亮快滿，馬匹失去，無過錯。）",
        "九五：有孚攣如，無咎。（白話：有誠信緊密相連，無過錯。）",
        "上九：翰音登于天，貞凶。（白話：高飛之聲登天，守正有凶。）"
      ]
    },
    {
      "id": 62,
      "name": "小過",
      "pinyin": "Xiao Guo",
      "symbol": "震上艮下",
      "trigram_upper": 1,
      "trigram_lower": 4,
      "short": "雷山小過",
      "ci": "亨，利貞，可小事，不可大事。飛鳥遺之音，不宜上，宜下，大吉。",
      "ci_white": "亨通，有利正固，可小事，不可大事。飛鳥遺音，不宜上，宜下，大吉。",
      "yao_white": [
        "初六：飛鳥以凶。（白話：飛鳥因此凶。）",
        "六二：過其祖，遇其妣；不及其君，遇其臣，无咎。（白話：超超過祖父，遇到祖母；不及君王，遇到大臣，無咎。）",
        "九三：弗過防之，從或戕之，凶。（白話：不超過防範，跟從或傷害，大凶。）",
        "九四：無咎，弗過遇之，往厲必戒，勿用永貞。（白話：無過錯，不超過遇見，前進有危險必戒備，勿用長久守正。）",
        "六五：雲不雨，自我西郊，公弋取彼在穴。（白話：密雲不雨，從我西郊，公爵用箭射取穴中之物。）",
        "上六：弗遇過之，飛鳥離之，凶，是謂災眚。（白話：不遇到而過分，飛鳥羅網之，凶，這叫災難。）"
      ]
    },
    {
      "id": 63,
      "name": "既濟",
      "pinyin": "Ji Ji",
      "symbol": "離上坎下",
      "trigram_upper": 5,
      "trigram_lower": 2,
      "short": "水火既濟",
      "ci": "亨小，利貞，初吉終亂。",
      "ci_white": "小通，守正吉，開始吉結束亂。",
      "yao_white": [
        "初九：曳其輪，濡其尾，無咎。（白話：拉住車輪，濕了狐尾，無過錯。）",
        "六二：婦喪其茀，勿逐，七日得。（白話：婦女丟失頭巾，勿追，七日後得回。）",
        "九三：高宗伐鬼方，三年克之，小人勿用。（白話：高宗征伐鬼方，三年攻克，小人勿用。）",
        "六四：繻有衣袽，終日戒。（白話：細繒有衣襟，整日戒備。）",
        "九五：東鄰殺牛，不如西鄰之禴祭，實受其福。（白話：東鄰殺牛祭祀，不如西鄰薄祭，實受其福。）",
        "上六：濡其首，厲。（白話：濕了頭頂，危險。）"
      ]
    },
    {
      "id": 64,
      "name": "未濟",
      "pinyin": "Wei Ji",
      "symbol": "坎上離下",
      "trigram_upper": 2,
      "trigram_lower": 5,
      "short": "火水未濟",
      "ci": "亨，小狐汔濟，濡其尾,无攸利。",
      "ci_white": "亨通，小狐快渡河，濡濕尾巴，無所利。",
      "yao_white": [
        "初六：濡其尾，吝。（白話：濡濕尾巴，有困難。）",
        "九二：曳其輪，貞吉。（白話：拉住車輪，守正吉利。）",
        "六三：未濟，征凶，利涉大川。（白話：未完成，出征有凶，利於渡大河。）",
        "九四：貞吉悔亡，震用伐鬼方，三年有賞於大國。（白話：守正吉利悔恨消失，用雷霆征伐鬼方，三年在大國受賞。）",
        "六五：貞吉無悔，君子之光，有孚吉。（白話：守正吉利無悔，君子之光，有誠信吉利。）",
        "上九：有孚于飲酒無咎，濡其首，有孚失是。（白話：有誠信於飲酒無過錯，濕了頭頂，有誠信失正道。）"
      ]
    }
  ],
  "array_8x8": [
    [2, 16, 8, 45, 23, 35, 20, 12],
    [24, 51, 3, 17, 27, 21, 42, 25],
    [7, 40, 29, 47, 4, 64, 59, 6],
    [19, 54, 60, 58, 41, 38, 61, 10],
    [15, 62, 39, 31, 52, 56, 53, 33],
    [36, 55, 63, 49, 22, 30, 37, 13],
    [46, 32, 48, 28, 18, 50, 57, 44],
    [11, 34, 5, 43, 26, 14, 9, 1]
  ]
}


ichingData.trigrams.forEach(trigram => {
  let baseTrigrams = trigram.binary + trigram.binary;
  let hexagram = ichingData.hexagrams.find((h => h.id === hexDict[baseTrigrams]));  
  const baseIndex = 5;

  //1. Base
  hexagram.selfIndex = baseIndex;
  hexagram.otherIndex = (baseIndex + 3) % 6;
  hexagram.baseElement = trigram.element;
  hexagram.baseTrigrams = trigram.name;
  console.log("base", baseTrigrams);

  //Change 1 - 5
  let changeTrigrams = baseTrigrams;
  let binaryArray = baseTrigrams.split(""); 

  for (let i = 1; i <= 5; i++) {
    binaryArray[5 - i + 1] = binaryArray[5 - i + 1] === '0' ? '1' : '0';
    changeTrigrams = binaryArray.join("");
    hexagram = ichingData.hexagrams.find((h => h.id === hexDict[changeTrigrams]));    
    hexagram.selfIndex = (baseIndex + i) % 6;
    hexagram.otherIndex = (hexagram.selfIndex + 3) % 6;     
    hexagram.baseElement = trigram.element;
    hexagram.baseTrigrams = trigram.name;
    console.log("change", changeTrigrams);
  }

  //Change 6
  binaryArray[2] = binaryArray[2] === '0' ? '1' : '0';
  changeTrigrams = binaryArray.join("");
    
  hexagram = ichingData.hexagrams.find((h => h.id === hexDict[changeTrigrams]));  
  hexagram.selfIndex = 3;
  hexagram.otherIndex = (hexagram.selfIndex + 3) % 6;
  hexagram.baseElement = trigram.element;
  hexagram.baseTrigrams = trigram.name;
  console.log("change", changeTrigrams);


  //change 7
  for (let i = 3; i < 6; i++) {
    binaryArray[i] = binaryArray[i] === '0' ? '1' : '0';
    changeTrigrams = binaryArray.join("");
  }
  hexagram = ichingData.hexagrams.find((h => h.id === hexDict[changeTrigrams]));  
  hexagram.selfIndex = 2;
  hexagram.otherIndex = (hexagram.selfIndex + 3) % 6;
  hexagram.baseElement = trigram.element;
  hexagram.baseTrigrams = trigram.name;
  console.log("change", changeTrigrams);


  console.log(ichingData.hexagrams);

});


// Create hexagram index
const hexagramById = {};
ichingData.hexagrams.forEach(hex => {
    hexagramById[hex.id] = hex;
});

// Create trigram index maps from embedded data
const trigramByBinary = {};
const trigramById = {};
const trigramByChar = {}

ichingData.trigrams.forEach(trigram => {
    trigramByBinary[trigram.binary] = trigram;
    trigramById[trigram.id] = trigram;
    trigramByChar[trigram.code] = trigram;
});


reverseHexDict = Object.fromEntries(
    Object.entries(hexDict).map(([key, value]) => [value, key])
);     




// Convert flip result to display string based on rules
function convertFlipResult(flip) {
    const headsCount = flip.filter(coin => coin === 'H').length;
    const tailsCount = flip.filter(coin => coin === 'T').length;

    // Rule a: 2 tail 1 head -> ---
    if (tailsCount === 2 && headsCount === 1) {
        return YANG_SYMBOL;
    }
    // Rule b: 2 head 1 tail -> - -
    else if (headsCount === 2 && tailsCount === 1) {
        return YIN_SYMBOL;        
    }
    // Rule c: 3 head -> ---O
    else if (headsCount === 3) {
        return YANG_MOVING_SYMBOL;
    }
    // Rule d: 3 tail -> - -X
    else if (tailsCount === 3) {
        return YIN_MOVING_SYMBOL;
    }
}

// Transform the main result to final result based on rules
function transformResult(mainResult) {
    // Rule 1: If the result is ---O, change it to - -
    if (mainResult === YANG_MOVING_SYMBOL) {
        return YIN_SYMBOL;
    }
    // Rule 2: If the result is - -X, change it to ---
    else if (mainResult === YIN_MOVING_SYMBOL) {
        return YANG_SYMBOL;
    }
    // Rule 3: Otherwise, keep the same
    else {
        return mainResult;
    }
}

// Convert a single result to binary (0 or 1)
function resultToBinary(result) {
    // --- or ---O = 1
    if (result === YANG_SYMBOL || result === YANG_MOVING_SYMBOL ) {
        return '1';
    }
    // - - or - -X = 0
    else if (result === YIN_SYMBOL || result === YIN_MOVING_SYMBOL) {
        return '0';
    }
    return '0'; // default
}

// Convert binary to symbol representation
function binaryToSymbol(binaryString) {
    // Convert each bit: 1 = '━━━' (solid line), 0 = '━ ━' (broken line)
    // Using Unicode box drawing characters for I Ching symbols
    let symbols = [];
    for (let i = 0; i < binaryString.length; i++) {
        symbols.push(binaryString[i] === '1' ? YANG_SYMBOL : YIN_SYMBOL);
    }
    return symbols;
}

// Calculate binary conversion for upper and lower groups
function calculateBinaryGroups(binaryResults) {
    // Upper 3 results (indices 5, 4, 3) - from flip 6, 5, 4
    const upperGroup = [binaryResults[5], binaryResults[4], binaryResults[3]];
    // Lower 3 results (indices 2, 1, 0) - from flip 3, 2, 1
    const lowerGroup = [binaryResults[2], binaryResults[1], binaryResults[0]];

    const upperBinary = upperGroup.map(result => resultToBinary(result)).join('');
    const lowerBinary = lowerGroup.map(result => resultToBinary(result)).join('');

    return { upper: upperBinary, lower: lowerBinary };
}

// Look up result number from hex dictionary using combined binary
function lookupResultNumber(upperBinary, lowerBinary) {
    const combinedBinary = upperBinary + lowerBinary;
    return hexDict[combinedBinary] || 'N/A';
}

// Generate and display the hex dictionary lookup table
function generateHexTable(mainBinary = null, finalBinary = null) {
    const tableElement = document.getElementById('hexTable');
    tableElement.innerHTML = ''; // Clear previous table
    

    

    
    // Header sequence in binary for columns
    const colHeaders = ['111', '011', '101', '001', '110', '010', '100', '000'];
    
    // Create thead
    const thead = document.createElement('thead');
    const headerRow = document.createElement('tr');
    headerRow.innerHTML = '<th></th>'; // Corner cell
    
    colHeaders.forEach(binary => {
        const th = document.createElement('th');
        const trigram = trigramByBinary[binary];
        
        // Display trigram name
        const nameDiv = document.createElement('div');
        nameDiv.textContent = trigram.name;
        th.appendChild(nameDiv);
        
        // Display binary as vertical symbols
        const symbols = binaryToSymbol(binary);
        const symbolDiv = document.createElement('div');
        symbolDiv.className = 'header-symbol';
        symbolDiv.textContent = trigram.code;
        // symbols.forEach((symbol, index) => {
        //     if (index > 0) {
        //         symbolDiv.appendChild(document.createElement('br'));
        //     }
        //     symbolDiv.appendChild(document.createTextNode(symbol));
        // });
        th.appendChild(symbolDiv);
        
        headerRow.appendChild(th);
    });
    thead.appendChild(headerRow);
    tableElement.appendChild(thead);
    
    // Create tbody
    const tbody = document.createElement('tbody');
    const rowHeaders = ['111', '011', '101', '001', '110', '010', '100', '000'];
    
    rowHeaders.forEach(rowBinary => {
        const row = document.createElement('tr');
        
        // Row header
        const rowHeaderCell = document.createElement('th');
        const rowTrigram = trigramByBinary[rowBinary];
        
        // Display trigram name
        const nameDiv = document.createElement('div');
        nameDiv.textContent = rowTrigram.name;
        rowHeaderCell.appendChild(nameDiv);
        
        // Display binary as vertical symbols
        const symbols = binaryToSymbol(rowBinary);
        const symbolDiv = document.createElement('div');
        symbolDiv.className = 'header-symbol';
        symbolDiv.textContent = rowTrigram.code;
        // symbols.forEach((symbol, index) => {
        //     if (index > 0) {
        //         symbolDiv.appendChild(document.createElement('br'));
        //     }
        //     symbolDiv.appendChild(document.createTextNode(symbol));
        // });
        rowHeaderCell.appendChild(symbolDiv);
        
        row.appendChild(rowHeaderCell);
        
        // Data cells
        colHeaders.forEach(colBinary => {
            const cell = document.createElement('td');
            const binaryValue = colBinary + rowBinary; // Column (Upper) + Row (Lower)
            const hexagramId = hexDict[binaryValue];
            const hexagram = hexagramById[hexagramId];
            
            cell.innerHTML = `
                <div class="hex-name">${hexagram.name}</div>
                <div class="hex-symbol">${hexagram.symbol}</div>
                <div class="hex-short">${hexagram.short}</div>
                <div class="hex-id">${hexagram.id}</div>                
            `;
            
            // Add click event to open modal
            cell.addEventListener('click', function() {
                openHexagramModal(hexagramId, hexagram.name);
            });
            
            // Add highlighting if this cell matches main or final result
            if (mainBinary && binaryValue === mainBinary) {
                cell.classList.add('main-result');
            }
            if (finalBinary && binaryValue === finalBinary) {
                cell.classList.add('final-result');
            }
            
            row.appendChild(cell);
        });
        
        tbody.appendChild(row);
    });
    tableElement.appendChild(tbody);
}

// Flip a single coin (returns 'H' for Heads or 'T' for Tails)
function flipCoin() {
    return Math.random() < 0.5 ? 'H' : 'T';
}

// Flip 3 coins once
function flipThreeCoins() {
    return [flipCoin(), flipCoin(), flipCoin()];
}

// Perform the simulation: flip 3 coins 6 times
function runSimulation() {
    const flips = [];
    for (let i = 0; i < 6; i++) {
        flips.push(flipThreeCoins());
    }
    return flips;
}

// Count heads and tails across all flips
function countResults(flips) {
    let headsCount = 0;
    let tailsCount = 0;

    flips.forEach(flip => {
        flip.forEach(coin => {
            if (coin === 'H') {
                headsCount++;
            } else {
                tailsCount++;
            }
        });
    });

    return { heads: headsCount, tails: tailsCount };
}

// Display the results on the page
function displayResults(flips) {
    const resultsSection = document.getElementById('results');
    const flipsContainer = document.getElementById('flipsContainer');
    const mainResultContainer = document.getElementById('mainResultContainer');
    const finalResultContainer = document.getElementById('finalResultContainer');
    
    // Clear previous results
    flipsContainer.innerHTML = '';
    mainResultContainer.innerHTML = '';
    finalResultContainer.innerHTML = '';
    
    const mainResults = []; // Store main results raw string 
    const finalResults = []; // Store final results raw string
    const changedIndexs = []; 
    const keptIndexs = [];
    
    // Store reference for highlighting
    window.highlightedBinaries = { main: null, final: null };
    
    // Display each flip result
    flips.forEach((flip, index) => {
        // Left column: Flip Results
        const flipDiv = document.createElement('div');
        flipDiv.className = 'flip-result';
        
        let flipHtml = `<h3>Flip ${index + 1}</h3>`;
        flip.forEach((coin) => {
            const coinClass = coin === 'H' ? 'heads' : 'tails';
            flipHtml += `<span class="coin ${coinClass}">${coin}</span>`;
        });
        
        flipDiv.innerHTML = flipHtml;
        flipsContainer.appendChild(flipDiv);

        // Middle column: Converted Results
        const mainResult = convertFlipResult(flip);
        mainResults.push(mainResult);
        if (mainResult === YANG_MOVING_SYMBOL || mainResult === YIN_MOVING_SYMBOL) {
            changedIndexs.push(index);
            console.log("Change Index:", index);
        }
        else {
            keptIndexs.push(index);
        }
        const mainDiv = document.createElement('div');
        mainDiv.className = 'main-result';
        mainDiv.innerHTML = `<pre>${mainResult}</pre>`;
        mainResultContainer.appendChild(mainDiv);

        // Right column: Final Results
        const finalResult = transformResult(mainResult);
        finalResults.push(finalResult);
        const finalDiv = document.createElement('div');
        finalDiv.className = 'final-result';
        finalDiv.innerHTML = `<pre>${finalResult}</pre>`;
        finalResultContainer.appendChild(finalDiv);
    });
    
    resultsSection.style.display = 'block';
    
    // Calculate and store binary values for highlighting
    const mainBinaryGroups = calculateBinaryGroups(mainResults);
    const finalBinaryGroups = calculateBinaryGroups(finalResults);
    window.highlightedBinaries.main = mainBinaryGroups.upper + mainBinaryGroups.lower;
    window.highlightedBinaries.final = finalBinaryGroups.upper + finalBinaryGroups.lower;
    
    // Display binary conversion summary for both columns
    displayBinarySummary(mainResults, finalResults);
    displayExplanation(mainResults, finalResults, changedIndexs, keptIndexs);
    
    // Return the binary values for table highlighting
    return {
        mainBinary: window.highlightedBinaries.main,
        finalBinary: window.highlightedBinaries.final
    };
}

// Create or update the bar chart
function displayChart(counts) {
    const ctx = document.getElementById('statisticsChart').getContext('2d');
    
    if (statisticsChart) {
        statisticsChart.destroy();
    }
    
    statisticsChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Heads', 'Tails'],
            datasets: [{
                label: 'Count',
                data: [counts.heads, counts.tails],
                backgroundColor: [
                    '#4CAF50',
                    '#FF9800'
                ],
                borderColor: [
                    '#45a049',
                    '#e68900'
                ],
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: true,
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: 'Coin Flip Results (3 coins × 6 flips = 18 total coins)'
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    max: 18,
                    ticks: {
                        stepSize: 2
                    }
                }
            }
        }
    });
    
    document.getElementById('chartSection').style.display = 'block';
}

function getLineNameFromBinary(bitString, index)
{
    let lineResult = "";
    let lineoutput = "";
    lineResult = bitString === '1' ? '九' : '六';
    const numnberToChinese = ["初","二","三","四","五","上"];    
    if (index === 5 || index === 0)
    {
        lineoutput += `\t${numnberToChinese[5-index]}${lineResult}`;
    }
    else
    {
        lineoutput += `\t${lineResult}${numnberToChinese[5-index]}`;            
    }
    return lineoutput;
}

function getLineSymbolFromBinary(bitString)
{
    let lineSymbol = "";
    lineSymbol = bitString === '1' ? YANG_SYMBOL : YIN_SYMBOL;
    return lineSymbol;
}

function getDiZhiListFromBinary(binaryString)
{
    let diZhiChineseList = [];
    let diZhiElementList = [];
    const trigram = ichingData.trigrams.find((t => t.binary === binaryString));

    for (let i = 0; i < 6; i++)   
    {
      if (trigram.YinYang == YANG) {        
        index = trigram.diZhiBase + (i * 2);
        index = index > 11 ? index - 12 : index;        
      }
      else {
        index = trigram.diZhiBase - (i * 2);
        index = index < 0 ? index + 12 : index; 
      }      
      //diZhiList.push(diZhiChinese[index] + diZhiElement[index]);
      diZhiChineseList.push(diZhiChinese[index]);
      diZhiElementList.push(diZhiElement[index]);
    }    
    
    //console.log(diZhiList);
    return [diZhiChineseList, diZhiElementList];
}

function getFamilyGroup(baseElement, elementList) {

  let familyGroups = [];
  elementList.forEach((element, index) => {
    console.log("Base Element:", baseElement, "Element:", element);
    if (baseElement === element) {
      familyGroups.push("兄弟");
    }
    else if (elementRelation[element].generate === baseElement) {
      familyGroups.push("父母");
    }
    else if (elementRelation[baseElement].generate === element) {
      familyGroups.push("子孫");
    }
    else if (elementRelation[element].overcome === baseElement) {
      familyGroups.push("官鬼");
    }
    else if (elementRelation[baseElement].overcome === element) {
      familyGroups.push("妻財");
    }
  });

  return familyGroups;
}
// function getLineSymbolAndNameFromBinary(hexagramId) {

//   let symbolLines = [];
//   let lineoutput = "";
//   [...reverseHexDict[hexagramId]].split('').forEach((bitString, index) => {
//     lineoutput = getLineSymbolFromBinary(bitString);
//     lineoutput += getLineNameFromBinary(bitString, index);
//     symbolLines.push(lineoutput);    
//   });
  
//   return symbolLines;
// }

// Open modal and display hexagram details
function openHexagramModal(hexagramId, hexagramName) {
    let lineoutput = "";
    const hexagram = ichingData.hexagrams.find(h => h.id === hexagramId);
    if (!hexagram) return;
   
    document.getElementById('modalTitle').textContent = `${hexagram.name} (${hexagram.pinyin}) - #${hexagramId}`;

    modelSymbol = document.getElementById('modalSymbol');
    modelSymbol.innerHTML = '';
    reverseHexDict[hexagramId].split('').forEach((bitString, index) => {
        const lineDiv = document.createElement('div');
        lineDiv.className = 'line-symbol';
        lineoutput = getLineSymbolFromBinary(bitString);
        lineoutput += getLineNameFromBinary(bitString, index);       
        lineDiv.innerHTML = `<pre>${lineoutput}</pre>`;
        modelSymbol.appendChild(lineDiv);
    });    

    
    document.getElementById('modalBody').textContent = hexagram.ci;
    document.getElementById('modalBodyWhite').textContent = hexagram.ci_white;
    modalBodyExplain = document.getElementById('modalBodyExplain');
    modalBodyExplain.innerHTML = "";
    //document.getElementById('modalBodyExplain').innerHTML = hexagram.yao_white;
    [...hexagram.yao_white].reverse().forEach(line => {
        const p = document.createElement("p"); // create a <p> for each line
        p.textContent = line;
        modalBodyExplain.appendChild(p);
    });
    document.getElementById('hexagramModal').style.display = 'flex';

}


// Display binary conversion summary
function displayBinarySummary(mainResults, finalResults) {
    const summarySection = document.getElementById('summarySection');
    const mainUpperBinaryDiv = document.getElementById('mainUpperBinary');
    const mainUpperBinarySymbolDiv = document.getElementById('mainUpperBinarySymbol');
    const mainLowerBinaryDiv = document.getElementById('mainLowerBinary');
    const mainLowerBinarySymbolDiv = document.getElementById('mainLowerBinarySymbol');
    const mainCombinedDiv = document.getElementById('mainCombined');
    const mainResultNumberDiv = document.getElementById('mainResultNumber');
    const mainResultNameDiv = document.getElementById('mainResultName');
    const mainResultShortNameDiv = document.getElementById('mainResultShortName');
    const mainResultSymbolDiv = document.getElementById('mainResultSymbol');
    const finalUpperBinaryDiv = document.getElementById('finalUpperBinary');
    const finalUpperBinarySymbolDiv = document.getElementById('finalUpperBinarySymbol');
    const finalLowerBinaryDiv = document.getElementById('finalLowerBinary');
    const finalLowerBinarySymbolDiv = document.getElementById('finalLowerBinarySymbol');
    const finalCombinedDiv = document.getElementById('finalCombined');
    const finalResultNumberDiv = document.getElementById('finalResultNumber');
    const finalResultNameDiv = document.getElementById('finalResultName');
    const finalResultShortNameDiv = document.getElementById('finalResultShortName');
    const finalResultSymbolDiv = document.getElementById('finalResultSymbol');
    
    const mainBinaryGroups = calculateBinaryGroups(mainResults);
    const finalBinaryGroups = calculateBinaryGroups(finalResults);
    

    // Display main results
    trigram = trigramByBinary[mainBinaryGroups.upper];    
    mainUpperBinaryDiv.textContent = mainBinaryGroups.upper;
    mainUpperBinarySymbolDiv.textContent = trigram.code;

    trigram = trigramByBinary[mainBinaryGroups.lower];        
    mainLowerBinaryDiv.textContent = mainBinaryGroups.lower;
    mainLowerBinarySymbolDiv.textContent = trigram.code;

    const mainCombined = mainBinaryGroups.upper + mainBinaryGroups.lower;
    mainCombinedDiv.textContent = mainCombined;
    const mainResultNumber = lookupResultNumber(mainBinaryGroups.upper, mainBinaryGroups.lower);
    mainResultNumberDiv.textContent = mainResultNumber;
    mainResultNameDiv.textContent = hexagramById[mainResultNumber].symbol;
    mainResultNameDiv.addEventListener('click', function() {
        openHexagramModal(mainResultNumber, hexagramById[mainResultNumber].name);
    });            
    mainResultShortNameDiv.textContent = hexagramById[mainResultNumber].short;
    mainResultShortNameDiv.addEventListener('click', function() {
        openHexagramModal(mainResultNumber, hexagramById[mainResultNumber].name);
    });            
            
    mainResultSymbolDiv.textContent = String.fromCodePoint(0x4DC0 + mainResultNumber - 1);
    
    // Display final results
    trigram = trigramByBinary[finalBinaryGroups.upper];        
    finalUpperBinaryDiv.textContent = finalBinaryGroups.upper;
    finalUpperBinarySymbolDiv.textContent = trigram.code;

    trigram = trigramByBinary[finalBinaryGroups.lower];
    finalLowerBinaryDiv.textContent = finalBinaryGroups.lower;
    finalLowerBinarySymbolDiv.textContent = trigram.code;

    const finalCombined = finalBinaryGroups.upper + finalBinaryGroups.lower;
    finalCombinedDiv.textContent = finalCombined;
    const finalResultNumber = lookupResultNumber(finalBinaryGroups.upper, finalBinaryGroups.lower);
    finalResultNumberDiv.textContent = finalResultNumber;
    finalResultNameDiv.textContent = hexagramById[finalResultNumber].symbol;
    finalResultNameDiv.addEventListener('click', function() {
        openHexagramModal(finalResultNumber, hexagramById[finalResultNumber].name);
    });            
    finalResultShortNameDiv.textContent = hexagramById[finalResultNumber].short;
    finalResultShortNameDiv.addEventListener('click', function() {
        openHexagramModal(finalResultNumber, hexagramById[finalResultNumber].name);
    });    

    
    finalResultSymbolDiv.textContent = String.fromCodePoint(0x4DC0 + finalResultNumber - 1);
    
    summarySection.style.display = 'block';
}

function getOverAllSymbolExplation(symbolNumber) {
  explanationLines = [];
  hexagram = ichingData.hexagrams.find(h => h.id === symbolNumber);

  if (!hexagram) {
    return;
  }  
  explanationLines.push(`【${hexagram.name} (${hexagram.pinyin}) - #${hexagram.id}】卦辭：${hexagram.ci} 白話：${hexagram.ci_white}`);
   [...hexagram.yao_white].forEach(line => {
        explanationLines.push(line)        
    });


  return explanationLines;
}


function displayExplanationSymbol(mainResults, finalResults, changedIndexs, keptIndexs){
  const mainExplanationDiv = document.getElementById('mainExplanationSymbol');  
  const finalExplanationDiv = document.getElementById('finalExplanationSymbol');

  mainExplanationDiv.innerHTML = "";
  finalExplanationDiv.innerHTML = "";

  const mainBinaryGroups = calculateBinaryGroups(mainResults);
  const finalBinaryGroups = calculateBinaryGroups(finalResults);

  const mainResultNumber = lookupResultNumber(mainBinaryGroups.upper, mainBinaryGroups.lower);
  const finalResultNumber = lookupResultNumber(finalBinaryGroups.upper, finalBinaryGroups.lower);
  

  let lineoutput = "";      
  const mainLineDiv = document.createElement('div');
  mainLineDiv.className = 'line-symbol';
  let [mainUpperDiZiChinese, mainUpperDiZiElement] = getDiZhiListFromBinary(mainBinaryGroups.upper);
  let [mainLowerDiZiChinese, mainLowerDiZiElement] = getDiZhiListFromBinary(mainBinaryGroups.lower);
  mainUpperDiZiChinese = mainUpperDiZiChinese.slice(3,6).reverse();
  mainLowerDiZiChinese = mainLowerDiZiChinese.slice(0,3).reverse();  
  mainUpperDiZiElement = mainUpperDiZiElement.slice(3,6).reverse();
  mainLowerDiZiElement = mainLowerDiZiElement.slice(0,3).reverse();  

  const mainDiZiChinese = mainUpperDiZiChinese.concat(mainLowerDiZiChinese);
  const mainDiZiElement = mainUpperDiZiElement.concat(mainLowerDiZiElement);

  let [finalUpperDiZiChinese, finalUpperDiZiElement] = getDiZhiListFromBinary(finalBinaryGroups.upper);
  let [finalLowerDiZiChinese, finalLowerDiZiElement] = getDiZhiListFromBinary(finalBinaryGroups.lower);
  finalUpperDiZiChinese = finalUpperDiZiChinese.slice(3,6).reverse();
  finalLowerDiZiChinese = finalLowerDiZiChinese.slice(0,3).reverse();
  finalUpperDiZiElement = finalUpperDiZiElement.slice(3,6).reverse();
  finalLowerDiZiElement = finalLowerDiZiElement.slice(0,3).reverse();

  const finalDiZiChinese = finalUpperDiZiChinese.concat(finalLowerDiZiChinese); 
  const finalDiZiElement = finalUpperDiZiElement.concat(finalLowerDiZiElement); 

  const mainFamilyGroup = getFamilyGroup(hexagramById[mainResultNumber].baseElement, mainDiZiElement);
  const finalFamilyGroup = getFamilyGroup(hexagramById[mainResultNumber].baseElement, finalDiZiElement);


  let mainTableData = [];
  let mainOtherList = [];
  [...mainResults].reverse().forEach((result, index) => {
      
      console.log("Result To Binary:", index, result);
      lineoutput += getLineSymbolFromBinary(resultToBinary(result));
      lineoutput += getLineNameFromBinary(resultToBinary(result), index);

      lineoutput += ` ${mainDiZiChinese[index]}${mainDiZiElement[index]}`;
      
      if (5 - index === hexagramById[mainResultNumber].selfIndex) {
          lineoutput += " ← 世爻";
          mainOtherList.push(" ← 世爻");
      }
      else if (5 - index === hexagramById[mainResultNumber].otherIndex) {
          lineoutput += " ← 應爻";   
          mainOtherList.push(" ← 應爻");       
      }
      else {
          mainOtherList.push("");
      }

      lineoutput += "\n";
      //lineDiv.innerHTML = `<pre>${lineoutput}</pre>`;      
      mainTableData.push([getLineSymbolFromBinary(resultToBinary(result)), getLineNameFromBinary(resultToBinary(result), index), mainDiZiChinese[index] + mainDiZiElement[index], mainFamilyGroup[index], mainOtherList[index]]);
  }); 

  //console.log("Table Data:", tableData); 

  // mainLineDiv.innerHTML = `<pre style="display:inline-block; text-align:left; font-family:monospace;">${lineoutput}</pre>`;      
  // mainExplanationDiv.appendChild(mainLineDiv);
    //  console.log("Line Output:", index, result); 

  const mainTableBody = document.getElementById("mainExplanationSymbolTable");
  mainTableBody.innerHTML = ""; // clear old rows


  const mainSymbolBase = document.createElement("tr");
  mainSymbolBase.innerHTML = hexagramById[mainResultNumber].baseTrigrams + "宮\t" + `${hexagramById[mainResultNumber].baseElement}`;
  mainTableBody.appendChild(mainSymbolBase);


  const maintableHeader = document.createElement("tr");
  maintableHeader.innerHTML = `<th>卦爻</th><th>名稱</th><th>地支</th><th>六親</th><th>世應</th>`;
  mainTableBody.appendChild(maintableHeader);
  

  mainTableData.forEach(row => {
    const tr = document.createElement("tr");
    row.forEach(cell => {
      const td = document.createElement("td");
      td.textContent = cell;
      tr.appendChild(td);
    });
    mainTableBody.appendChild(tr);
  });


  lineoutput = "";
  let finalTableData = [];
  let finalOtherList = [];
  const finalLineDiv = document.createElement('div');
  finalLineDiv.className = 'line-symbol';
  [...finalResults].reverse().forEach((result, index) => {     
     
      
      lineoutput += getLineSymbolFromBinary(resultToBinary(result));
      lineoutput += getLineNameFromBinary(resultToBinary(result), index);       

      lineoutput += ` ${finalDiZiChinese[index]}${finalDiZiElement[index]}`;

      if (5 - index === hexagramById[finalResultNumber].selfIndex) {
          lineoutput += " ← 世爻";
            finalOtherList.push(" ← 世爻"); 
      }
      else if (5 - index === hexagramById[finalResultNumber].otherIndex) {
          lineoutput += " ← 應爻";         
          finalOtherList.push(" ← 應爻"); 
      }      
      else {
          finalOtherList.push("");
      }
      lineoutput += "\n";
      finalTableData.push([getLineSymbolFromBinary(resultToBinary(result)), getLineNameFromBinary(resultToBinary(result), index), finalDiZiChinese[index] + finalDiZiElement[index], finalFamilyGroup[index], finalOtherList[index]]);
  }); 

  // finalLineDiv.innerHTML = `<pre style="display:inline-block; text-align:left; font-family:monospace;">${lineoutput}</pre>`;      
  // finalExplanationDiv.appendChild(finalLineDiv); 



  const finalTableBody = document.getElementById("finalExplanationSymbolTable");
  finalTableBody.innerHTML = ""; // clear old rows

  const finalSymbolBase = document.createElement("tr");
  finalSymbolBase.innerHTML = hexagramById[finalResultNumber].baseTrigrams + "宮\t" + `${hexagramById[finalResultNumber].baseElement}`;
  finalTableBody.appendChild(finalSymbolBase);


  const tr = document.createElement("tr");
  tr.innerHTML = `<th>卦爻</th><th>名稱</th><th>地支</th><th>六親</th><th>世應</th>`;
  finalTableBody.appendChild(tr);

  finalTableData.forEach(row => {
    const tr = document.createElement("tr");
    row.forEach(cell => {
      const td = document.createElement("td");
      td.textContent = cell;
      tr.appendChild(td);
    });
    finalTableBody.appendChild(tr);
  });

}


//Display Explanation Section
function displayExplanation(mainResults, finalResults, changedIndexs, keptIndexs) {

  if (changedIndexs.length + keptIndexs.length !== 6) {
    return;
  }

  displayExplanationSymbol(mainResults, finalResults, changedIndexs, keptIndexs);

  const explanationSection = document.getElementById('explanationSection');
  const explanationText = document.getElementById('explanationText');
  
  const mainBinaryGroups = calculateBinaryGroups(mainResults);
  const finalBinaryGroups = calculateBinaryGroups(finalResults);    

  // Display main results
  const mainResultNumber = lookupResultNumber(mainBinaryGroups.upper, mainBinaryGroups.lower);
  const finalResultNumber = lookupResultNumber(finalBinaryGroups.upper, finalBinaryGroups.lower);
  
  const mainHexagram = ichingData.hexagrams.find(h => h.id === mainResultNumber);
  const finalHexagram = ichingData.hexagrams.find(h => h.id === finalResultNumber);

  let explanationOutput = ""
  const mainExplanations = getOverAllSymbolExplation(mainResultNumber);
  const finalExplanations = getOverAllSymbolExplation(finalResultNumber);

  if (changedIndexs.length === 0) {
      explanationOutput = "六爻都未變：以本卦卦辭為斷。";  
      //explanationOutput += `<br><br>本卦【${mainHexagram.name} (${mainHexagram.pinyin}) - #${mainHexagram.id}】卦辭：${mainHexagram.ci} 白話：${mainHexagram.ci_white}`;
      explanationOutput += `<br><br> ${mainExplanations[0]}`        
  }
  else if (changedIndexs.length === 1) {
      explanationOutput = "一爻變，以本卦變爻為斷。";  
      const changedIndex = changedIndexs[0] + 1;

      console.log("1st Changed Index:",changedIndexs[0], changedIndex);
      explanationOutput += `<br><br> 本卦${mainExplanations[0]}`        
      if (changedIndex >= 1 && changedIndex <= mainExplanations.length) {
        explanationOutput += `<br><br> ${mainExplanations[changedIndex]}`;
      }
  }
  else if (changedIndexs.length === 2) {
      console.log("2 change");
      explanationOutput = "二爻變，以本卦變爻的上爻為斷。變爻的下爻可做為參考。";  
      const changedIndex1 = changedIndexs[0] + 1;
      const changedIndex2 = changedIndexs[1] + 1;
      explanationOutput += `<br><br> 本卦${mainExplanations[0]}`
      if (changedIndex2 >= 1 && changedIndex2 <= mainExplanations.length) {
        explanationOutput += `<br><br> ${mainExplanations[changedIndex2]}`;
      }
      if (changedIndex1 >= 1 && changedIndex1 <= mainExplanations.length) {
        explanationOutput += `<br><br> ${mainExplanations[changedIndex1]}`;
      }
  }
  else if (changedIndexs.length === 3) {
      explanationOutput = "三爻變，以變卦的卦辭為斷；本卦卦辭可當參考。";  
      explanationOutput += `<br><br> 變卦${finalExplanations[0]}`;
      explanationOutput += `<br><br> 本卦${mainExplanations[0]}`;
  }
  else if (changedIndexs.length === 4) {
      explanationOutput = "四爻變，以變卦不變的二爻中的下爻為斷，上爻可做為參考。";  
      explanationOutput += `<br><br> 變卦${finalExplanations[0]}`;
      const keptIndex1 = keptIndexs[0] + 1;
      const keptIndex2 = keptIndexs[1] + 1;
      if (keptIndex1 >= 1 && keptIndex1 <= finalExplanations.length) {
        explanationOutput += `<br><br> ${finalExplanations[keptIndex1]}`;
      }

      if (keptIndex2 >= 1 && keptIndex2 <= finalExplanations.length) {
        explanationOutput += `<br><br> ${finalExplanations[keptIndex2]}`;
      }
  }
  else if (changedIndexs.length === 5) {
      explanationOutput = "五爻變，以變卦不變的那一爻為斷";  
      explanationOutput += `<br><br> 變卦${finalExplanations[0]}`;
      const keptIndex = keptIndexs[0] + 1;
      if (keptIndex >= 1 && keptIndex <= finalExplanations.length) {
        explanationOutput += `<br><br> ${finalExplanations[keptIndex]}`;
      }
  }
  else if (changedIndexs.length === 6) {
      explanationOutput = "六爻皆變。"; 
      explanationOutput += `<br><br> 變卦${finalExplanations[0]}`;
  }

  //explanationSection.innerHTML = `<pre>${explanationOutput}</pre>`;
  explanationText.innerHTML = `<div class="explanation-text">${explanationOutput}</div>`
  explanationSection.style.display = 'block';


// 六爻都未變：以本卦卦辭為斷。
// 一爻變，以本卦變爻為斷。
// 二爻變，以本卦變爻的上爻為斷。變爻的下爻可做為參考。
// 三爻變，以變卦的卦辭為斷；本卦卦辭可當參考。
// 四爻變，以變卦不變的二爻中的下爻為斷，上爻可做為參考。
// 五爻變，以變卦不變的那一爻為斷
}

// Main function to handle button click
function handleFlipButton() {

    console.log("Flip button clicked");
    const flips = runSimulation();
    const counts = countResults(flips);
    
    const { mainBinary, finalBinary } = displayResults(flips);
    displayChart(counts);
    generateHexTable(mainBinary, finalBinary);
    
    // Show table section
    document.getElementById('tableSection').style.display = 'block';
}


// Close modal
function closeHexagramModal() {
    document.getElementById('hexagramModal').style.display = 'none';
}

// Attach event listeners
document.getElementById('flipBtn').addEventListener('click', handleFlipButton);

// Close modal when clicking the X button
document.querySelector('.modal-close').addEventListener('click', closeHexagramModal);

// Close modal when clicking outside the modal content
window.addEventListener('click', function(event) {
    const modal = document.getElementById('hexagramModal');
    if (event.target === modal) {
        closeHexagramModal();
    }
});

// 六爻都未變：以本卦卦辭為斷。
// 一爻變，以本卦變爻為斷。
// 二爻變，以本卦變爻的上爻為斷。變爻的下爻可做為參考。
// 三爻變，以變卦的卦辭為斷；本卦卦辭可當參考。
// 四爻變，以變卦不變的二爻中的下爻為斷，上爻可做為參考。
// 五爻變，以變卦不變的那一爻為斷
